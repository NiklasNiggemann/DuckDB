
=== Phase 1: Running benchmarks ===

[START] polars

------------------------------------------------

[STRESS-BIG] Reading 10 tables for this run...

------------------------------------------------

shape: (1, 1)
┌───────────┐
│ cnt       │
│ ---       │
│ u32       │
╞═══════════╡
│ 731000390 │
└───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    22     70.8 MiB     70.8 MiB           1   @profile
    23                                         def stress_test(scale_factors: List[int]):
    24     70.8 MiB      0.0 MiB           3       union_query = " UNION ALL ".join([
    25     70.8 MiB      0.0 MiB          12           f"SELECT * FROM read_parquet('tpc/lineitem_{sf}.parquet')" for sf in scale_factors
    26                                             ])
    27   5582.7 MiB   5512.0 MiB           3       df = pl.SQLContext().execute(
    28     70.8 MiB      0.0 MiB           2           f"""
    29                                                 SELECT COUNT(*) AS cnt
    30     70.8 MiB      0.0 MiB           1           FROM ({union_query}) AS all_lineitems
    31                                                 WHERE l_shipdate >= DATE '1994-01-01'
    32                                                   AND l_shipdate <  DATE '1995-01-01'
    33                                                   AND l_discount BETWEEN 0.05 AND 0.07
    34                                                   AND l_quantity < 24;
    35                                                 """,
    36     70.8 MiB      0.0 MiB           1           eager=False
    37   5488.6 MiB    -94.1 MiB           1       ).collect(engine="streaming")
    38   5489.3 MiB    -93.3 MiB           1       print(df)


Memory = 5419.69 MB, Time = 87.72 s

------------------------------------------------

[STRESS-BIG] Reading 20 tables for this run...

------------------------------------------------

shape: (1, 1)
┌────────────┐
│ cnt        │
│ ---        │
│ u32        │
╞════════════╡
│ 1462000780 │
└────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    22     71.0 MiB     71.0 MiB           1   @profile
    23                                         def stress_test(scale_factors: List[int]):
    24     71.0 MiB      0.0 MiB           3       union_query = " UNION ALL ".join([
    25     71.0 MiB      0.0 MiB          22           f"SELECT * FROM read_parquet('tpc/lineitem_{sf}.parquet')" for sf in scale_factors
    26                                             ])
    27   9155.9 MiB   3802.8 MiB           3       df = pl.SQLContext().execute(
    28     71.1 MiB      0.0 MiB           2           f"""
    29                                                 SELECT COUNT(*) AS cnt
    30     71.1 MiB      0.0 MiB           1           FROM ({union_query}) AS all_lineitems
    31                                                 WHERE l_shipdate >= DATE '1994-01-01'
    32                                                   AND l_shipdate <  DATE '1995-01-01'
    33                                                   AND l_discount BETWEEN 0.05 AND 0.07
    34                                                   AND l_quantity < 24;
    35                                                 """,
    36     71.1 MiB      0.0 MiB           1           eager=False
    37   9155.8 MiB   5282.2 MiB           1       ).collect(engine="streaming")
    38   9156.6 MiB      0.7 MiB           1       print(df)


Memory = 9086.48 MB, Time = 183.63 s

------------------------------------------------

[STRESS-BIG] Reading 30 tables for this run...

------------------------------------------------

shape: (1, 1)
┌────────────┐
│ cnt        │
│ ---        │
│ u32        │
╞════════════╡
│ 2193001170 │
└────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    22     71.2 MiB     71.2 MiB           1   @profile
    23                                         def stress_test(scale_factors: List[int]):
    24     71.2 MiB      0.0 MiB           3       union_query = " UNION ALL ".join([
    25     71.2 MiB      0.0 MiB          32           f"SELECT * FROM read_parquet('tpc/lineitem_{sf}.parquet')" for sf in scale_factors
    26                                             ])
    27  12620.0 MiB   6532.3 MiB           3       df = pl.SQLContext().execute(
    28     71.3 MiB      0.0 MiB           2           f"""
    29                                                 SELECT COUNT(*) AS cnt
    30     71.3 MiB      0.0 MiB           1           FROM ({union_query}) AS all_lineitems
    31                                                 WHERE l_shipdate >= DATE '1994-01-01'
    32                                                   AND l_shipdate <  DATE '1995-01-01'
    33                                                   AND l_discount BETWEEN 0.05 AND 0.07
    34                                                   AND l_quantity < 24;
    35                                                 """,
    36     71.3 MiB      0.0 MiB           1           eager=False
    37  12619.9 MiB   6016.4 MiB           1       ).collect(engine="streaming")
    38  12620.8 MiB      0.8 MiB           1       print(df)


Memory = 12550.69 MB, Time = 508.53 s

------------------------------------------------

[STRESS-BIG] Reading 40 tables for this run...

------------------------------------------------

shape: (1, 1)
┌────────────┐
│ cnt        │
│ ---        │
│ u32        │
╞════════════╡
│ 2924001560 │
└────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    22     71.0 MiB     71.0 MiB           1   @profile
    23                                         def stress_test(scale_factors: List[int]):
    24     71.0 MiB      0.0 MiB           3       union_query = " UNION ALL ".join([
    25     71.0 MiB      0.0 MiB          42           f"SELECT * FROM read_parquet('tpc/lineitem_{sf}.parquet')" for sf in scale_factors
    26                                             ])
    27  15824.0 MiB  11983.8 MiB           3       df = pl.SQLContext().execute(
    28     71.0 MiB      0.0 MiB           2           f"""
    29                                                 SELECT COUNT(*) AS cnt
    30     71.0 MiB      0.0 MiB           1           FROM ({union_query}) AS all_lineitems
    31                                                 WHERE l_shipdate >= DATE '1994-01-01'
    32                                                   AND l_shipdate <  DATE '1995-01-01'
    33                                                   AND l_discount BETWEEN 0.05 AND 0.07
    34                                                   AND l_quantity < 24;
    35                                                 """,
    36     71.0 MiB      0.0 MiB           1           eager=False
    37  15823.9 MiB   3769.3 MiB           1       ).collect(engine="streaming")
    38  15824.9 MiB      0.8 MiB           1       print(df)


Memory = 15754.91 MB, Time = 484.63 s

------------------------------------------------

[STRESS-BIG] Reading 50 tables for this run...

------------------------------------------------

shape: (1, 1)
┌────────────┐
│ cnt        │
│ ---        │
│ u32        │
╞════════════╡
│ 3655001950 │
└────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    22     71.1 MiB     71.1 MiB           1   @profile
    23                                         def stress_test(scale_factors: List[int]):
    24     71.1 MiB      0.0 MiB           3       union_query = " UNION ALL ".join([
    25     71.1 MiB      0.0 MiB          52           f"SELECT * FROM read_parquet('tpc/lineitem_{sf}.parquet')" for sf in scale_factors
    26                                             ])
    27  17755.1 MiB   8418.0 MiB           3       df = pl.SQLContext().execute(
    28     71.1 MiB      0.0 MiB           2           f"""
    29                                                 SELECT COUNT(*) AS cnt
    30     71.1 MiB      0.0 MiB           1           FROM ({union_query}) AS all_lineitems
    31                                                 WHERE l_shipdate >= DATE '1994-01-01'
    32                                                   AND l_shipdate <  DATE '1995-01-01'
    33                                                   AND l_discount BETWEEN 0.05 AND 0.07
    34                                                   AND l_quantity < 24;
    35                                                 """,
    36     71.1 MiB      0.0 MiB           1           eager=False
    37  17755.0 MiB   9266.0 MiB           1       ).collect(engine="streaming")
    38  17755.8 MiB      0.7 MiB           1       print(df)


Memory = 17685.73 MB, Time = 611.07 s

------------------------------------------------

[STRESS-BIG] Reading 60 tables for this run...

------------------------------------------------

Run failed: 
thread '<unnamed>' (3338079) panicked at crates/polars-expr/src/reduce/len.rs:86:43:
Polars' maximum length reached. Consider installing 'polars[rt64]'.: TryFromIntError(())
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
Traceback (most recent call last):
  File "/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/benchmark_engine.py", line 70, in <module>
    main()
    ~~~~^^
  File "/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/benchmark_engine.py", line 67, in main
    benchmark(tool, test, args.factor, args.factors)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/benchmark_engine.py", line 37, in benchmark
    tool.stress_test(factors)
    ~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/.venv/lib/python3.14/site-packages/memory_profiler.py", line 1188, in wrapper
    val = prof(func)(*args, **kwargs)
  File "/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/.venv/lib/python3.14/site-packages/memory_profiler.py", line 761, in f
    return func(*args, **kwds)
  File "/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/polars_olap.py", line 37, in stress_test
    ).collect(engine="streaming")
      ~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/.venv/lib/python3.14/site-packages/polars/_utils/deprecation.py", line 97, in wrapper
    return function(*args, **kwargs)
  File "/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/.venv/lib/python3.14/site-packages/polars/lazyframe/opt_flags.py", line 328, in wrapper
    return function(*args, **kwargs)
  File "/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/.venv/lib/python3.14/site-packages/polars/lazyframe/frame.py", line 2422, in collect
    return wrap_df(ldf.collect(engine, callback))
                   ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
pyo3_runtime.PanicException: Polars' maximum length reached. Consider installing 'polars[rt64]'.: TryFromIntError(())

Warning: Could not parse output!

--- Elapsed Time (s) ---
Mean:   375.12
Std:    226.24
CV:     60.3%
Min:    87.72
Max:    611.07
Span:   523.35

------------------------------------------------

--- Memory Used (MB) ---
Mean:   12099.50
Std:    4961.60
CV:     41.0%
Min:    5419.69
Max:    17685.73
Span:   12266.04

------------------------------------------------

[START] duckdb

------------------------------------------------

[STRESS-BIG] Reading 10 tables for this run...

------------------------------------------------

shape: (1, 1)
┌───────────┐
│ cnt       │
│ ---       │
│ i64       │
╞═══════════╡
│ 731000390 │
└───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def stress_test(scale_factors: List[int]):
    22     73.8 MiB      2.8 MiB           1       con = duckdb.connect()
    23     73.8 MiB      0.0 MiB           3       union_query = " UNION ALL ".join([
    24     73.8 MiB      0.0 MiB          12           f"SELECT * FROM 'tpc/lineitem_{sf}.parquet'" for sf in scale_factors
    25                                             ])
    26     73.8 MiB      0.0 MiB           2       query = f"""
    27                                             SELECT COUNT(*) AS cnt
    28     73.8 MiB      0.0 MiB           1       FROM ({union_query}) AS all_lineitems
    29                                             WHERE l_shipdate >= DATE '1994-01-01'
    30                                               AND l_shipdate <  DATE '1995-01-01'
    31                                               AND l_discount BETWEEN 0.05 AND 0.07
    32                                               AND l_quantity < 24;
    33                                             """
    34   5365.0 MiB   5291.2 MiB           1       print(con.sql(query).pl())


Memory = 5288.56 MB, Time = 92.77 s

------------------------------------------------

[STRESS-BIG] Reading 20 tables for this run...

------------------------------------------------

shape: (1, 1)
┌────────────┐
│ cnt        │
│ ---        │
│ i64        │
╞════════════╡
│ 1462000780 │
└────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def stress_test(scale_factors: List[int]):
    22     73.9 MiB      2.7 MiB           1       con = duckdb.connect()
    23     73.9 MiB      0.0 MiB           3       union_query = " UNION ALL ".join([
    24     73.9 MiB      0.0 MiB          22           f"SELECT * FROM 'tpc/lineitem_{sf}.parquet'" for sf in scale_factors
    25                                             ])
    26     73.9 MiB      0.0 MiB           2       query = f"""
    27                                             SELECT COUNT(*) AS cnt
    28     73.9 MiB      0.0 MiB           1       FROM ({union_query}) AS all_lineitems
    29                                             WHERE l_shipdate >= DATE '1994-01-01'
    30                                               AND l_shipdate <  DATE '1995-01-01'
    31                                               AND l_discount BETWEEN 0.05 AND 0.07
    32                                               AND l_quantity < 24;
    33                                             """
    34   9565.8 MiB   9491.9 MiB           1       print(con.sql(query).pl())


Memory = 9483.14 MB, Time = 186.51 s

------------------------------------------------

[STRESS-BIG] Reading 30 tables for this run...

------------------------------------------------

shape: (1, 1)
┌────────────┐
│ cnt        │
│ ---        │
│ i64        │
╞════════════╡
│ 2193001170 │
└────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def stress_test(scale_factors: List[int]):
    22     73.8 MiB      2.6 MiB           1       con = duckdb.connect()
    23     73.8 MiB      0.0 MiB           3       union_query = " UNION ALL ".join([
    24     73.8 MiB      0.0 MiB          32           f"SELECT * FROM 'tpc/lineitem_{sf}.parquet'" for sf in scale_factors
    25                                             ])
    26     73.8 MiB      0.0 MiB           2       query = f"""
    27                                             SELECT COUNT(*) AS cnt
    28     73.8 MiB      0.0 MiB           1       FROM ({union_query}) AS all_lineitems
    29                                             WHERE l_shipdate >= DATE '1994-01-01'
    30                                               AND l_shipdate <  DATE '1995-01-01'
    31                                               AND l_discount BETWEEN 0.05 AND 0.07
    32                                               AND l_quantity < 24;
    33                                             """
    34  13755.9 MiB  13682.0 MiB           1       print(con.sql(query).pl())


Memory = 13684.67 MB, Time = 278.56 s

------------------------------------------------

[STRESS-BIG] Reading 40 tables for this run...

------------------------------------------------

shape: (1, 1)
┌────────────┐
│ cnt        │
│ ---        │
│ i64        │
╞════════════╡
│ 2924001560 │
└────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def stress_test(scale_factors: List[int]):
    22     73.8 MiB      2.7 MiB           1       con = duckdb.connect()
    23     73.8 MiB      0.0 MiB           3       union_query = " UNION ALL ".join([
    24     73.8 MiB      0.0 MiB          42           f"SELECT * FROM 'tpc/lineitem_{sf}.parquet'" for sf in scale_factors
    25                                             ])
    26     73.8 MiB      0.0 MiB           2       query = f"""
    27                                             SELECT COUNT(*) AS cnt
    28     73.8 MiB      0.0 MiB           1       FROM ({union_query}) AS all_lineitems
    29                                             WHERE l_shipdate >= DATE '1994-01-01'
    30                                               AND l_shipdate <  DATE '1995-01-01'
    31                                               AND l_discount BETWEEN 0.05 AND 0.07
    32                                               AND l_quantity < 24;
    33                                             """
    34  17940.7 MiB  17866.8 MiB           1       print(con.sql(query).pl())


Memory = 17869.50 MB, Time = 369.26 s

------------------------------------------------

[STRESS-BIG] Reading 50 tables for this run...

------------------------------------------------

shape: (1, 1)
┌────────────┐
│ cnt        │
│ ---        │
│ i64        │
╞════════════╡
│ 3655001950 │
└────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def stress_test(scale_factors: List[int]):
    22     73.8 MiB      2.8 MiB           1       con = duckdb.connect()
    23     73.9 MiB      0.0 MiB           3       union_query = " UNION ALL ".join([
    24     73.9 MiB      0.0 MiB          52           f"SELECT * FROM 'tpc/lineitem_{sf}.parquet'" for sf in scale_factors
    25                                             ])
    26     73.9 MiB      0.0 MiB           2       query = f"""
    27                                             SELECT COUNT(*) AS cnt
    28     73.9 MiB      0.0 MiB           1       FROM ({union_query}) AS all_lineitems
    29                                             WHERE l_shipdate >= DATE '1994-01-01'
    30                                               AND l_shipdate <  DATE '1995-01-01'
    31                                               AND l_discount BETWEEN 0.05 AND 0.07
    32                                               AND l_quantity < 24;
    33                                             """
    34  20464.4 MiB  20390.6 MiB           1       print(con.sql(query).pl())


Memory = 20396.64 MB, Time = 463.06 s

------------------------------------------------

[STRESS-BIG] Reading 60 tables for this run...

------------------------------------------------

shape: (1, 1)
┌────────────┐
│ cnt        │
│ ---        │
│ i64        │
╞════════════╡
│ 4386002340 │
└────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def stress_test(scale_factors: List[int]):
    22     73.8 MiB      2.7 MiB           1       con = duckdb.connect()
    23     73.9 MiB      0.0 MiB           3       union_query = " UNION ALL ".join([
    24     73.9 MiB      0.0 MiB          62           f"SELECT * FROM 'tpc/lineitem_{sf}.parquet'" for sf in scale_factors
    25                                             ])
    26     73.9 MiB      0.0 MiB           2       query = f"""
    27                                             SELECT COUNT(*) AS cnt
    28     73.9 MiB      0.0 MiB           1       FROM ({union_query}) AS all_lineitems
    29                                             WHERE l_shipdate >= DATE '1994-01-01'
    30                                               AND l_shipdate <  DATE '1995-01-01'
    31                                               AND l_discount BETWEEN 0.05 AND 0.07
    32                                               AND l_quantity < 24;
    33                                             """
    34  20413.7 MiB  20339.8 MiB           1       print(con.sql(query).pl())


Memory = 20352.16 MB, Time = 555.49 s

------------------------------------------------

[STRESS-BIG] Reading 70 tables for this run...

------------------------------------------------

shape: (1, 1)
┌────────────┐
│ cnt        │
│ ---        │
│ i64        │
╞════════════╡
│ 5117002730 │
└────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def stress_test(scale_factors: List[int]):
    22     73.7 MiB      2.7 MiB           1       con = duckdb.connect()
    23     73.7 MiB      0.0 MiB           3       union_query = " UNION ALL ".join([
    24     73.7 MiB      0.0 MiB          72           f"SELECT * FROM 'tpc/lineitem_{sf}.parquet'" for sf in scale_factors
    25                                             ])
    26     73.7 MiB      0.0 MiB           2       query = f"""
    27                                             SELECT COUNT(*) AS cnt
    28     73.7 MiB      0.0 MiB           1       FROM ({union_query}) AS all_lineitems
    29                                             WHERE l_shipdate >= DATE '1994-01-01'
    30                                               AND l_shipdate <  DATE '1995-01-01'
    31                                               AND l_discount BETWEEN 0.05 AND 0.07
    32                                               AND l_quantity < 24;
    33                                             """
    34  19346.8 MiB  19273.1 MiB           1       print(con.sql(query).pl())


Memory = 19286.34 MB, Time = 654.47 s

------------------------------------------------

[STRESS-BIG] Reading 80 tables for this run...

------------------------------------------------

shape: (1, 1)
┌────────────┐
│ cnt        │
│ ---        │
│ i64        │
╞════════════╡
│ 5848003120 │
└────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def stress_test(scale_factors: List[int]):
    22     73.8 MiB      2.6 MiB           1       con = duckdb.connect()
    23     73.8 MiB      0.0 MiB           3       union_query = " UNION ALL ".join([
    24     73.8 MiB      0.0 MiB          82           f"SELECT * FROM 'tpc/lineitem_{sf}.parquet'" for sf in scale_factors
    25                                             ])
    26     73.8 MiB      0.0 MiB           2       query = f"""
    27                                             SELECT COUNT(*) AS cnt
    28     73.8 MiB      0.0 MiB           1       FROM ({union_query}) AS all_lineitems
    29                                             WHERE l_shipdate >= DATE '1994-01-01'
    30                                               AND l_shipdate <  DATE '1995-01-01'
    31                                               AND l_discount BETWEEN 0.05 AND 0.07
    32                                               AND l_quantity < 24;
    33                                             """
    34  20182.5 MiB  20108.7 MiB           1       print(con.sql(query).pl())


Memory = 20127.73 MB, Time = 750.10 s

------------------------------------------------

[STRESS-BIG] Reading 90 tables for this run...

------------------------------------------------

shape: (1, 1)
┌────────────┐
│ cnt        │
│ ---        │
│ i64        │
╞════════════╡
│ 6579003510 │
└────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     70.9 MiB     70.9 MiB           1   @profile
    21                                         def stress_test(scale_factors: List[int]):
    22     73.6 MiB      2.7 MiB           1       con = duckdb.connect()
    23     73.7 MiB      0.0 MiB           3       union_query = " UNION ALL ".join([
    24     73.7 MiB      0.0 MiB          92           f"SELECT * FROM 'tpc/lineitem_{sf}.parquet'" for sf in scale_factors
    25                                             ])
    26     73.7 MiB      0.0 MiB           2       query = f"""
    27                                             SELECT COUNT(*) AS cnt
    28     73.7 MiB      0.0 MiB           1       FROM ({union_query}) AS all_lineitems
    29                                             WHERE l_shipdate >= DATE '1994-01-01'
    30                                               AND l_shipdate <  DATE '1995-01-01'
    31                                               AND l_discount BETWEEN 0.05 AND 0.07
    32                                               AND l_quantity < 24;
    33                                             """
    34  19189.0 MiB  19115.3 MiB           1       print(con.sql(query).pl())


Memory = 19135.08 MB, Time = 880.68 s

--- Elapsed Time (s) ---
Mean:   470.10
Std:    264.09
CV:     56.2%
Min:    92.77
Max:    880.68
Span:   787.91

------------------------------------------------

--- Memory Used (MB) ---
Mean:   16180.42
Std:    5496.66
CV:     34.0%
Min:    5288.56
Max:    20396.64
Span:   15108.08

------------------------------------------------

=== Phase 2: Plotting figures (saving to disk) ===
Plot saved to results/polars_duckdb_stress-big_memory.png
Plot saved to results/polars_duckdb_stress-big_time.png
