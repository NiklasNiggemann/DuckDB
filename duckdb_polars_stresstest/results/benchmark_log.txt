
=== Phase 1: Running benchmarks ===

[START] polars - stress

------------------------------------------------

[STRESS] Reading 2 tables with ca. 280 GB ...

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.4 MiB     71.4 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.4 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1307.9 MiB   1236.5 MiB           1       run_polars_query(parquet_files)


Memory = 1237.39 MB, Time = 13.39 s

------------------------------------------------

[STRESS] Reading 4 tables with ca. 560 GB ...

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     70.6 MiB     70.6 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     70.6 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2301.2 MiB   2230.6 MiB           1       run_polars_query(parquet_files)


Memory = 2231.55 MB, Time = 23.17 s

------------------------------------------------

[STRESS] Reading 6 tables with ca. 840 GB ...

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     70.9 MiB     70.9 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     70.9 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2712.0 MiB   2641.1 MiB           1       run_polars_query(parquet_files)


Memory = 2642.02 MB, Time = 31.59 s

------------------------------------------------

[STRESS] Reading 8 tables with ca. 1120 GB ...

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2797.7 MiB   2726.5 MiB           1       run_polars_query(parquet_files)


Memory = 2727.45 MB, Time = 42.67 s

--- Elapsed Time (s) ---
Mean:   27.71
Std:    12.44
CV:     44.9%
Min:    13.39
Max:    42.67
Span:   29.28

------------------------------------------------

--- Memory Used (MB) ---
Mean:   2209.60
Std:    683.33
CV:     30.9%
Min:    1237.39
Max:    2727.45
Span:   1490.06

------------------------------------------------

[START] duckdb - stress

------------------------------------------------

[STRESS] Reading 2 tables with ca. 280 GB ...

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1725.0 MiB   1653.8 MiB           1       run_query(parquet_files)


Memory = 1653.95 MB, Time = 9.13 s

------------------------------------------------

[STRESS] Reading 4 tables with ca. 560 GB ...

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.3 MiB     71.3 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.3 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2559.9 MiB   2488.6 MiB           1       run_query(parquet_files)


Memory = 2488.80 MB, Time = 16.84 s

------------------------------------------------

[STRESS] Reading 6 tables with ca. 840 GB ...

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   3492.8 MiB   3421.7 MiB           1       run_query(parquet_files)


Memory = 3421.86 MB, Time = 25.32 s

------------------------------------------------

[STRESS] Reading 8 tables with ca. 1120 GB ...

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   4332.2 MiB   4261.0 MiB           1       run_query(parquet_files)


Memory = 4261.12 MB, Time = 35.64 s

--- Elapsed Time (s) ---
Mean:   21.73
Std:    11.39
CV:     52.4%
Min:    9.13
Max:    35.64
Span:   26.51

------------------------------------------------

--- Memory Used (MB) ---
Mean:   2956.43
Std:    1130.48
CV:     38.2%
Min:    1653.95
Max:    4261.12
Span:   2607.17

------------------------------------------------

=== Phase 2: Plotting figures (saving to disk) ===
Plot saved to results/polars_duckdb_stress_memory.png
Plot saved to results/polars_duckdb_stress_time.png
