
=== Phase 1: Running benchmarks ===

[START] polars - normal

------------------------------------------------

[NORMAL] Reading a table with ca. 2.2 GB ...
Run 1 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     70.9 MiB     70.9 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     70.9 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    204.8 MiB    133.9 MiB           1       run_polars_query([parquet_path])


Memory = 134.02 MB, Time = 0.09 s
Run 2 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.0 MiB     71.0 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    199.6 MiB    128.5 MiB           1       run_polars_query([parquet_path])


Memory = 128.67 MB, Time = 0.09 s
Run 3 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     70.9 MiB     70.9 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     70.9 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    210.7 MiB    139.8 MiB           1       run_polars_query([parquet_path])


Memory = 139.91 MB, Time = 0.09 s
Run 4 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     70.8 MiB     70.8 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     70.8 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    196.2 MiB    125.4 MiB           1       run_polars_query([parquet_path])


Memory = 125.52 MB, Time = 0.09 s
Run 5 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.3 MiB     71.3 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.3 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    208.0 MiB    136.7 MiB           1       run_polars_query([parquet_path])


Memory = 136.80 MB, Time = 0.09 s
Run 6 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     70.7 MiB     70.7 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     70.7 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    203.4 MiB    132.7 MiB           1       run_polars_query([parquet_path])


Memory = 132.81 MB, Time = 0.09 s
Run 7 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    198.0 MiB    126.7 MiB           1       run_polars_query([parquet_path])


Memory = 126.89 MB, Time = 0.09 s
Run 8 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.3 MiB     71.3 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.3 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    210.0 MiB    138.7 MiB           1       run_polars_query([parquet_path])


Memory = 138.80 MB, Time = 0.09 s
Run 9 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     70.7 MiB     70.7 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     70.7 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    199.5 MiB    128.8 MiB           1       run_polars_query([parquet_path])


Memory = 128.94 MB, Time = 0.09 s
Run 10 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    193.0 MiB    122.0 MiB           1       run_polars_query([parquet_path])


Memory = 122.08 MB, Time = 0.08 s

------------------------------------------------

[NORMAL] Reading a table with ca. 4.4 GB ...
Run 1 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.3 MiB     71.3 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.3 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    214.4 MiB    143.1 MiB           1       run_polars_query([parquet_path])


Memory = 143.19 MB, Time = 0.16 s
Run 2 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    220.5 MiB    149.2 MiB           1       run_polars_query([parquet_path])


Memory = 149.31 MB, Time = 0.15 s
Run 3 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    221.2 MiB    150.0 MiB           1       run_polars_query([parquet_path])


Memory = 150.11 MB, Time = 0.15 s
Run 4 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    221.0 MiB    149.8 MiB           1       run_polars_query([parquet_path])


Memory = 149.86 MB, Time = 0.15 s
Run 5 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    214.9 MiB    143.7 MiB           1       run_polars_query([parquet_path])


Memory = 143.84 MB, Time = 0.15 s
Run 6 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     70.7 MiB     70.7 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     70.7 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    213.8 MiB    143.1 MiB           1       run_polars_query([parquet_path])


Memory = 143.27 MB, Time = 0.15 s
Run 7 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    213.6 MiB    142.5 MiB           1       run_polars_query([parquet_path])


Memory = 142.56 MB, Time = 0.15 s
Run 8 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     70.9 MiB     70.9 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     70.9 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    224.6 MiB    153.8 MiB           1       run_polars_query([parquet_path])


Memory = 153.89 MB, Time = 0.15 s
Run 9 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    239.8 MiB    168.6 MiB           1       run_polars_query([parquet_path])


Memory = 168.73 MB, Time = 0.15 s
Run 10 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     70.9 MiB     70.9 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     70.9 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    215.5 MiB    144.6 MiB           1       run_polars_query([parquet_path])


Memory = 144.69 MB, Time = 0.15 s

------------------------------------------------

[NORMAL] Reading a table with ca. 8.8 GB ...
Run 1 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.3 MiB     71.3 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.3 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    244.2 MiB    172.9 MiB           1       run_polars_query([parquet_path])


Memory = 172.98 MB, Time = 0.30 s
Run 2 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    249.7 MiB    178.6 MiB           1       run_polars_query([parquet_path])


Memory = 178.77 MB, Time = 0.29 s
Run 3 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     70.9 MiB     70.9 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     70.9 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    249.5 MiB    178.6 MiB           1       run_polars_query([parquet_path])


Memory = 178.73 MB, Time = 0.29 s
Run 4 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    250.9 MiB    179.7 MiB           1       run_polars_query([parquet_path])


Memory = 179.80 MB, Time = 0.28 s
Run 5 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    248.6 MiB    177.4 MiB           1       run_polars_query([parquet_path])


Memory = 177.50 MB, Time = 0.29 s
Run 6 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    252.6 MiB    181.4 MiB           1       run_polars_query([parquet_path])


Memory = 181.53 MB, Time = 0.29 s
Run 7 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.0 MiB     71.0 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    247.3 MiB    176.2 MiB           1       run_polars_query([parquet_path])


Memory = 176.34 MB, Time = 0.29 s
Run 8 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    249.0 MiB    178.0 MiB           1       run_polars_query([parquet_path])


Memory = 178.09 MB, Time = 0.29 s
Run 9 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    257.1 MiB    185.9 MiB           1       run_polars_query([parquet_path])


Memory = 186.05 MB, Time = 0.29 s
Run 10 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.0 MiB     71.0 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    242.5 MiB    171.5 MiB           1       run_polars_query([parquet_path])


Memory = 171.66 MB, Time = 0.29 s

------------------------------------------------

[NORMAL] Reading a table with ca. 17.6 GB ...
Run 1 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.6 MiB     71.6 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.6 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    276.3 MiB    204.7 MiB           1       run_polars_query([parquet_path])


Memory = 204.86 MB, Time = 0.92 s
Run 2 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    797.2 MiB    726.0 MiB           1       run_polars_query([parquet_path])


Memory = 696.59 MB, Time = 0.57 s
Run 3 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    747.7 MiB    676.5 MiB           1       run_polars_query([parquet_path])


Memory = 651.44 MB, Time = 0.57 s
Run 4 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.3 MiB     71.3 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.3 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    388.6 MiB    317.2 MiB           1       run_polars_query([parquet_path])


Memory = 283.69 MB, Time = 0.64 s
Run 5 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    306.6 MiB    235.5 MiB           1       run_polars_query([parquet_path])


Memory = 235.56 MB, Time = 0.57 s
Run 6 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    843.3 MiB    772.2 MiB           1       run_polars_query([parquet_path])


Memory = 734.52 MB, Time = 0.55 s
Run 7 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.0 MiB     71.0 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    302.3 MiB    231.3 MiB           1       run_polars_query([parquet_path])


Memory = 231.38 MB, Time = 0.58 s
Run 8 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    296.0 MiB    224.8 MiB           1       run_polars_query([parquet_path])


Memory = 224.94 MB, Time = 0.57 s
Run 9 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.6 MiB     71.6 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.6 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    781.7 MiB    710.1 MiB           1       run_polars_query([parquet_path])


Memory = 672.47 MB, Time = 0.57 s
Run 10 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.0 MiB     71.0 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    693.0 MiB    621.9 MiB           1       run_polars_query([parquet_path])


Memory = 596.84 MB, Time = 0.56 s

------------------------------------------------

[NORMAL] Reading a table with ca. 35.2 GB ...
Run 1 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    348.7 MiB    277.6 MiB           1       run_polars_query([parquet_path])


Memory = 277.69 MB, Time = 1.86 s
Run 2 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    700.1 MiB    629.0 MiB           1       run_polars_query([parquet_path])


Memory = 612.45 MB, Time = 1.14 s
Run 3 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   2083.4 MiB   2012.2 MiB           1       run_polars_query([parquet_path])


Memory = 1991.50 MB, Time = 1.13 s
Run 4 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   2093.1 MiB   2022.0 MiB           1       run_polars_query([parquet_path])


Memory = 2001.28 MB, Time = 1.13 s
Run 5 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   2062.7 MiB   1991.5 MiB           1       run_polars_query([parquet_path])


Memory = 1970.78 MB, Time = 1.13 s
Run 6 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   2034.7 MiB   1963.5 MiB           1       run_polars_query([parquet_path])


Memory = 1946.42 MB, Time = 1.13 s
Run 7 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   1983.3 MiB   1912.2 MiB           1       run_polars_query([parquet_path])


Memory = 1891.48 MB, Time = 1.13 s
Run 8 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     70.7 MiB     70.7 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     70.7 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    881.6 MiB    810.9 MiB           1       run_polars_query([parquet_path])


Memory = 794.50 MB, Time = 1.15 s
Run 9 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    832.0 MiB    760.8 MiB           1       run_polars_query([parquet_path])


Memory = 744.12 MB, Time = 1.14 s
Run 10 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    781.1 MiB    709.9 MiB           1       run_polars_query([parquet_path])


Memory = 697.28 MB, Time = 1.14 s

------------------------------------------------

[NORMAL] Reading a table with ca. 70.4 GB ...
Run 1 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    508.4 MiB    437.2 MiB           1       run_polars_query([parquet_path])


Memory = 437.31 MB, Time = 3.63 s
Run 2 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   3363.2 MiB   3292.2 MiB           1       run_polars_query([parquet_path])


Memory = 3273.44 MB, Time = 2.25 s
Run 3 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.3 MiB     71.3 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.3 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   4279.6 MiB   4208.2 MiB           1       run_polars_query([parquet_path])


Memory = 4187.64 MB, Time = 2.23 s
Run 4 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.0 MiB     71.0 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   3379.3 MiB   3308.2 MiB           1       run_polars_query([parquet_path])


Memory = 3289.20 MB, Time = 2.27 s
Run 5 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   4411.7 MiB   4340.6 MiB           1       run_polars_query([parquet_path])


Memory = 4322.28 MB, Time = 2.24 s
Run 6 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.0 MiB     71.0 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   4335.8 MiB   4264.8 MiB           1       run_polars_query([parquet_path])


Memory = 4244.34 MB, Time = 2.25 s
Run 7 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   4262.1 MiB   4191.0 MiB           1       run_polars_query([parquet_path])


Memory = 4170.44 MB, Time = 2.23 s
Run 8 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   4033.1 MiB   3961.9 MiB           1       run_polars_query([parquet_path])


Memory = 3940.97 MB, Time = 2.22 s
Run 9 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   3274.5 MiB   3203.4 MiB           1       run_polars_query([parquet_path])


Memory = 3184.77 MB, Time = 2.24 s
Run 10 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.0 MiB     71.0 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   4245.9 MiB   4175.0 MiB           1       run_polars_query([parquet_path])


Memory = 4154.11 MB, Time = 2.23 s

------------------------------------------------

[NORMAL] Reading a table with ca. 140.8 GB ...
Run 1 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.3 MiB     71.3 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.3 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24    670.6 MiB    599.3 MiB           1       run_polars_query([parquet_path])


Memory = 600.33 MB, Time = 7.90 s
Run 2 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.5 MiB     71.5 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.5 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   6869.6 MiB   6798.1 MiB           1       run_polars_query([parquet_path])


Memory = 6777.73 MB, Time = 4.51 s
Run 3 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     70.9 MiB     70.9 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     70.9 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   7880.3 MiB   7809.4 MiB           1       run_polars_query([parquet_path])


Memory = 7791.81 MB, Time = 4.52 s
Run 4 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   8093.7 MiB   8022.5 MiB           1       run_polars_query([parquet_path])


Memory = 8002.12 MB, Time = 4.46 s
Run 5 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   6943.9 MiB   6872.8 MiB           1       run_polars_query([parquet_path])


Memory = 6851.98 MB, Time = 4.43 s
Run 6 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     70.9 MiB     70.9 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     70.9 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   7896.5 MiB   7825.6 MiB           1       run_polars_query([parquet_path])


Memory = 7805.27 MB, Time = 4.48 s
Run 7 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   8598.5 MiB   8527.5 MiB           1       run_polars_query([parquet_path])


Memory = 8508.38 MB, Time = 4.43 s
Run 8 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   7478.8 MiB   7407.6 MiB           1       run_polars_query([parquet_path])


Memory = 7385.83 MB, Time = 4.43 s
Run 9 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.1 MiB     71.1 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   7807.0 MiB   7735.9 MiB           1       run_polars_query([parquet_path])


Memory = 7715.42 MB, Time = 4.45 s
Run 10 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    21     71.2 MiB     71.2 MiB           1   @profile
    22                                         def normal_test(scale_factor: int):
    23     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    24   8027.6 MiB   7956.4 MiB           1       run_polars_query([parquet_path])


Memory = 7935.78 MB, Time = 4.48 s

--- Elapsed Time (s) ---
Mean:   1.36
Std:    1.72
CV:     126.2%
Min:    0.09
Max:    4.81
Span:   4.72

------------------------------------------------

--- Memory Used (MB) ---
Mean:   1808.92
Std:    2567.89
CV:     142.0%
Min:    131.44
Max:    6937.47
Span:   6806.02

------------------------------------------------

[START] polars - stress-small

------------------------------------------------

[STRESS-SMALL] Reading 1 files with ca. 2.06 GB ...
Run 1 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    188.8 MiB    117.7 MiB           1       run_polars_query(parquet_files)


Memory = 117.83 MB, Time = 0.14 s
Run 2 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     70.8 MiB     70.8 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     70.8 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    200.1 MiB    129.3 MiB           1       run_polars_query(parquet_files)


Memory = 129.42 MB, Time = 0.09 s
Run 3 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    201.3 MiB    130.3 MiB           1       run_polars_query(parquet_files)


Memory = 130.42 MB, Time = 0.09 s
Run 4 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    198.4 MiB    127.2 MiB           1       run_polars_query(parquet_files)


Memory = 127.38 MB, Time = 0.09 s
Run 5 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    199.8 MiB    128.8 MiB           1       run_polars_query(parquet_files)


Memory = 128.88 MB, Time = 0.09 s
Run 6 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    204.0 MiB    132.8 MiB           1       run_polars_query(parquet_files)


Memory = 132.97 MB, Time = 0.09 s
Run 7 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    201.5 MiB    130.4 MiB           1       run_polars_query(parquet_files)


Memory = 130.55 MB, Time = 0.09 s
Run 8 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    205.0 MiB    133.8 MiB           1       run_polars_query(parquet_files)


Memory = 133.94 MB, Time = 0.09 s
Run 9 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    198.7 MiB    127.6 MiB           1       run_polars_query(parquet_files)


Memory = 127.69 MB, Time = 0.09 s
Run 10 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.4 MiB     71.4 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.4 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    198.9 MiB    127.6 MiB           1       run_polars_query(parquet_files)


Memory = 127.70 MB, Time = 0.09 s

------------------------------------------------

[STRESS-SMALL] Reading 2 files with ca. 4.12 GB ...
Run 1 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    260.3 MiB    189.2 MiB           1       run_polars_query(parquet_files)


Memory = 189.36 MB, Time = 0.15 s
Run 2 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.5 MiB     71.5 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.5 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    261.6 MiB    190.2 MiB           1       run_polars_query(parquet_files)


Memory = 190.27 MB, Time = 0.15 s
Run 3 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     70.9 MiB     70.9 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     70.9 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    255.6 MiB    184.7 MiB           1       run_polars_query(parquet_files)


Memory = 184.83 MB, Time = 0.15 s
Run 4 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    256.2 MiB    185.2 MiB           1       run_polars_query(parquet_files)


Memory = 185.34 MB, Time = 0.15 s
Run 5 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    251.7 MiB    180.5 MiB           1       run_polars_query(parquet_files)


Memory = 180.66 MB, Time = 0.15 s
Run 6 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     70.8 MiB     70.8 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     70.8 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    283.0 MiB    212.2 MiB           1       run_polars_query(parquet_files)


Memory = 212.39 MB, Time = 0.19 s
Run 7 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    272.1 MiB    200.9 MiB           1       run_polars_query(parquet_files)


Memory = 201.09 MB, Time = 0.19 s
Run 8 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     70.9 MiB     70.9 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     70.9 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    258.0 MiB    187.1 MiB           1       run_polars_query(parquet_files)


Memory = 187.19 MB, Time = 0.15 s
Run 9 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    257.3 MiB    186.1 MiB           1       run_polars_query(parquet_files)


Memory = 186.20 MB, Time = 0.15 s
Run 10 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    254.3 MiB    183.2 MiB           1       run_polars_query(parquet_files)


Memory = 183.33 MB, Time = 0.16 s

------------------------------------------------

[STRESS-SMALL] Reading 4 files with ca. 8.24 GB ...
Run 1 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    382.7 MiB    311.7 MiB           1       run_polars_query(parquet_files)


Memory = 311.78 MB, Time = 0.29 s
Run 2 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    382.1 MiB    311.0 MiB           1       run_polars_query(parquet_files)


Memory = 311.11 MB, Time = 0.29 s
Run 3 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.3 MiB     71.3 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    369.0 MiB    297.7 MiB           1       run_polars_query(parquet_files)


Memory = 297.81 MB, Time = 0.28 s
Run 4 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    367.7 MiB    296.6 MiB           1       run_polars_query(parquet_files)


Memory = 296.67 MB, Time = 0.28 s
Run 5 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    386.8 MiB    315.5 MiB           1       run_polars_query(parquet_files)


Memory = 315.64 MB, Time = 0.29 s
Run 6 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    389.4 MiB    318.4 MiB           1       run_polars_query(parquet_files)


Memory = 318.48 MB, Time = 0.28 s
Run 7 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    379.6 MiB    308.5 MiB           1       run_polars_query(parquet_files)


Memory = 308.62 MB, Time = 0.28 s
Run 8 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     70.9 MiB     70.9 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     70.9 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    375.3 MiB    304.5 MiB           1       run_polars_query(parquet_files)


Memory = 304.61 MB, Time = 0.28 s
Run 9 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     70.7 MiB     70.7 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     70.7 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    386.2 MiB    315.4 MiB           1       run_polars_query(parquet_files)


Memory = 315.56 MB, Time = 0.30 s
Run 10 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    383.0 MiB    312.0 MiB           1       run_polars_query(parquet_files)


Memory = 312.12 MB, Time = 0.29 s

------------------------------------------------

[STRESS-SMALL] Reading 8 files with ca. 16.48 GB ...
Run 1 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     70.8 MiB     70.8 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     70.8 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    591.5 MiB    520.7 MiB           1       run_polars_query(parquet_files)


Memory = 520.84 MB, Time = 0.56 s
Run 2 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.4 MiB     71.4 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.4 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    613.2 MiB    541.8 MiB           1       run_polars_query(parquet_files)


Memory = 541.92 MB, Time = 0.55 s
Run 3 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    602.9 MiB    532.0 MiB           1       run_polars_query(parquet_files)


Memory = 532.09 MB, Time = 0.54 s
Run 4 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    604.7 MiB    533.5 MiB           1       run_polars_query(parquet_files)


Memory = 533.70 MB, Time = 0.55 s
Run 5 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.4 MiB     71.4 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.4 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    615.3 MiB    543.9 MiB           1       run_polars_query(parquet_files)


Memory = 544.02 MB, Time = 0.55 s
Run 6 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    633.4 MiB    562.3 MiB           1       run_polars_query(parquet_files)


Memory = 562.42 MB, Time = 0.56 s
Run 7 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.3 MiB     71.3 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    599.7 MiB    528.4 MiB           1       run_polars_query(parquet_files)


Memory = 528.50 MB, Time = 0.62 s
Run 8 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     72.0 MiB     72.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     72.0 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    601.0 MiB    529.0 MiB           1       run_polars_query(parquet_files)


Memory = 529.12 MB, Time = 0.59 s
Run 9 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    605.4 MiB    534.2 MiB           1       run_polars_query(parquet_files)


Memory = 534.38 MB, Time = 0.55 s
Run 10 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    618.0 MiB    546.8 MiB           1       run_polars_query(parquet_files)


Memory = 546.91 MB, Time = 0.55 s

------------------------------------------------

[STRESS-SMALL] Reading 18 files with ca. 37.08 GB ...
Run 1 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    864.9 MiB    793.8 MiB           1       run_polars_query(parquet_files)


Memory = 793.98 MB, Time = 1.25 s
Run 2 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    842.1 MiB    771.0 MiB           1       run_polars_query(parquet_files)


Memory = 771.08 MB, Time = 1.22 s
Run 3 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    859.7 MiB    788.7 MiB           1       run_polars_query(parquet_files)


Memory = 788.83 MB, Time = 1.22 s
Run 4 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    834.2 MiB    763.0 MiB           1       run_polars_query(parquet_files)


Memory = 763.19 MB, Time = 1.21 s
Run 5 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    885.7 MiB    814.7 MiB           1       run_polars_query(parquet_files)


Memory = 814.83 MB, Time = 1.22 s
Run 6 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    874.3 MiB    803.2 MiB           1       run_polars_query(parquet_files)


Memory = 803.31 MB, Time = 1.23 s
Run 7 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    839.3 MiB    768.2 MiB           1       run_polars_query(parquet_files)


Memory = 768.30 MB, Time = 1.20 s
Run 8 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    856.7 MiB    785.7 MiB           1       run_polars_query(parquet_files)


Memory = 785.78 MB, Time = 1.20 s
Run 9 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.3 MiB     71.3 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    875.8 MiB    804.5 MiB           1       run_polars_query(parquet_files)


Memory = 804.62 MB, Time = 1.19 s
Run 10 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    848.5 MiB    777.3 MiB           1       run_polars_query(parquet_files)


Memory = 777.41 MB, Time = 1.21 s

------------------------------------------------

[STRESS-SMALL] Reading 36 files with ca. 74.16 GB ...
Run 1 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.3 MiB     71.3 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    963.4 MiB    892.1 MiB           1       run_polars_query(parquet_files)


Memory = 892.23 MB, Time = 2.44 s
Run 2 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    955.9 MiB    884.8 MiB           1       run_polars_query(parquet_files)


Memory = 884.91 MB, Time = 2.35 s
Run 3 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    959.1 MiB    887.9 MiB           1       run_polars_query(parquet_files)


Memory = 888.06 MB, Time = 2.35 s
Run 4 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.3 MiB     71.3 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    972.5 MiB    901.2 MiB           1       run_polars_query(parquet_files)


Memory = 901.33 MB, Time = 2.37 s
Run 5 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.3 MiB     71.3 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    953.7 MiB    882.4 MiB           1       run_polars_query(parquet_files)


Memory = 882.52 MB, Time = 2.33 s
Run 6 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     70.9 MiB     70.9 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     70.9 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    956.3 MiB    885.3 MiB           1       run_polars_query(parquet_files)


Memory = 885.47 MB, Time = 2.41 s
Run 7 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    967.3 MiB    896.1 MiB           1       run_polars_query(parquet_files)


Memory = 896.19 MB, Time = 2.35 s
Run 8 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    961.5 MiB    890.3 MiB           1       run_polars_query(parquet_files)


Memory = 890.45 MB, Time = 2.39 s
Run 9 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    970.0 MiB    898.8 MiB           1       run_polars_query(parquet_files)


Memory = 898.92 MB, Time = 2.37 s
Run 10 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     70.9 MiB     70.9 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     70.9 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    966.8 MiB    895.9 MiB           1       run_polars_query(parquet_files)


Memory = 896.06 MB, Time = 2.37 s

------------------------------------------------

[STRESS-SMALL] Reading 72 files with ca. 148.32 GB ...
Run 1 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1057.9 MiB    986.7 MiB           1       run_polars_query(parquet_files)


Memory = 986.86 MB, Time = 4.68 s
Run 2 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1045.1 MiB    974.1 MiB           1       run_polars_query(parquet_files)


Memory = 974.20 MB, Time = 4.68 s
Run 3 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     70.6 MiB     70.6 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     70.6 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1027.0 MiB    956.4 MiB           1       run_polars_query(parquet_files)


Memory = 956.52 MB, Time = 4.69 s
Run 4 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1048.0 MiB    976.7 MiB           1       run_polars_query(parquet_files)


Memory = 976.84 MB, Time = 4.61 s
Run 5 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1043.8 MiB    972.6 MiB           1       run_polars_query(parquet_files)


Memory = 972.73 MB, Time = 4.60 s
Run 6 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1050.7 MiB    979.5 MiB           1       run_polars_query(parquet_files)


Memory = 979.59 MB, Time = 4.65 s
Run 7 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1018.1 MiB    947.0 MiB           1       run_polars_query(parquet_files)


Memory = 947.11 MB, Time = 4.68 s
Run 8 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1053.6 MiB    982.5 MiB           1       run_polars_query(parquet_files)


Memory = 982.62 MB, Time = 4.64 s
Run 9 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1076.3 MiB   1005.1 MiB           1       run_polars_query(parquet_files)


Memory = 1005.20 MB, Time = 4.69 s
Run 10 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1042.5 MiB    971.5 MiB           1       run_polars_query(parquet_files)


Memory = 971.58 MB, Time = 4.68 s

--- Elapsed Time (s) ---
Mean:   1.34
Std:    1.67
CV:     125.1%
Min:    0.10
Max:    4.66
Span:   4.57

------------------------------------------------

--- Memory Used (MB) ---
Mean:   545.64
Std:    346.14
CV:     63.4%
Min:    128.68
Max:    975.33
Span:   846.65

------------------------------------------------

[START] polars - stress-big

------------------------------------------------

[STRESS-BIG] Reading 1 files with ca. 137.49 GB ...
Run 1 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    718.8 MiB    647.8 MiB           1       run_polars_query(parquet_files)


Memory = 648.77 MB, Time = 4.94 s
Run 2 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    776.0 MiB    705.0 MiB           1       run_polars_query(parquet_files)


Memory = 705.95 MB, Time = 4.70 s
Run 3 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.3 MiB     71.3 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    843.8 MiB    772.5 MiB           1       run_polars_query(parquet_files)


Memory = 772.59 MB, Time = 4.69 s
Run 4 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    767.0 MiB    695.8 MiB           1       run_polars_query(parquet_files)


Memory = 695.92 MB, Time = 4.74 s
Run 5 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    841.3 MiB    770.3 MiB           1       run_polars_query(parquet_files)


Memory = 770.42 MB, Time = 4.55 s
Run 6 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   7152.7 MiB   7081.8 MiB           1       run_polars_query(parquet_files)


Memory = 7058.30 MB, Time = 4.51 s
Run 7 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    845.3 MiB    774.3 MiB           1       run_polars_query(parquet_files)


Memory = 774.42 MB, Time = 4.64 s
Run 8 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   4522.5 MiB   4451.4 MiB           1       run_polars_query(parquet_files)


Memory = 4418.45 MB, Time = 4.49 s
Run 9 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   7584.8 MiB   7513.7 MiB           1       run_polars_query(parquet_files)


Memory = 7485.03 MB, Time = 4.43 s
Run 10 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29    855.0 MiB    783.8 MiB           1       run_polars_query(parquet_files)


Memory = 783.89 MB, Time = 4.62 s

------------------------------------------------

[STRESS-BIG] Reading 2 files with ca. 274.98 GB ...
Run 1 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1364.1 MiB   1293.1 MiB           1       run_polars_query(parquet_files)


Memory = 1294.02 MB, Time = 8.95 s
Run 2 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1233.0 MiB   1162.0 MiB           1       run_polars_query(parquet_files)


Memory = 1163.02 MB, Time = 10.28 s
Run 3 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.3 MiB     71.3 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1364.9 MiB   1293.6 MiB           1       run_polars_query(parquet_files)


Memory = 1294.33 MB, Time = 9.99 s
Run 4 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1234.5 MiB   1163.3 MiB           1       run_polars_query(parquet_files)


Memory = 1164.36 MB, Time = 9.34 s
Run 5 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   7474.6 MiB   7403.5 MiB           1       run_polars_query(parquet_files)


Memory = 7373.19 MB, Time = 8.84 s
Run 6 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1386.7 MiB   1315.7 MiB           1       run_polars_query(parquet_files)


Memory = 1315.78 MB, Time = 8.91 s
Run 7 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.3 MiB     71.3 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1433.6 MiB   1362.2 MiB           1       run_polars_query(parquet_files)


Memory = 1362.41 MB, Time = 8.78 s
Run 8 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1380.9 MiB   1309.9 MiB           1       run_polars_query(parquet_files)


Memory = 1310.02 MB, Time = 9.00 s
Run 9 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   8257.3 MiB   8186.2 MiB           1       run_polars_query(parquet_files)


Memory = 8162.84 MB, Time = 8.72 s
Run 10 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.3 MiB     71.3 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   6173.7 MiB   6102.5 MiB           1       run_polars_query(parquet_files)


Memory = 6069.56 MB, Time = 8.69 s

------------------------------------------------

[STRESS-BIG] Reading 3 files with ca. 412.47 GB ...
Run 1 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2166.1 MiB   2095.0 MiB           1       run_polars_query(parquet_files)


Memory = 2095.94 MB, Time = 13.70 s
Run 2 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1836.4 MiB   1765.3 MiB           1       run_polars_query(parquet_files)


Memory = 1766.25 MB, Time = 13.59 s
Run 3 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1800.3 MiB   1729.2 MiB           1       run_polars_query(parquet_files)


Memory = 1729.50 MB, Time = 13.66 s
Run 4 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1931.9 MiB   1860.8 MiB           1       run_polars_query(parquet_files)


Memory = 1860.92 MB, Time = 13.85 s
Run 5 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1905.2 MiB   1834.0 MiB           1       run_polars_query(parquet_files)


Memory = 1834.11 MB, Time = 13.76 s
Run 6 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1924.8 MiB   1853.8 MiB           1       run_polars_query(parquet_files)


Memory = 1854.81 MB, Time = 13.17 s
Run 7 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.3 MiB     71.3 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1975.1 MiB   1903.8 MiB           1       run_polars_query(parquet_files)


Memory = 1903.98 MB, Time = 13.06 s
Run 8 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1977.7 MiB   1906.5 MiB           1       run_polars_query(parquet_files)


Memory = 1906.67 MB, Time = 13.27 s
Run 9 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1939.4 MiB   1868.1 MiB           1       run_polars_query(parquet_files)


Memory = 1868.28 MB, Time = 13.08 s
Run 10 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1806.1 MiB   1735.1 MiB           1       run_polars_query(parquet_files)


Memory = 1736.05 MB, Time = 13.58 s

------------------------------------------------

[STRESS-BIG] Reading 4 files with ca. 549.96 GB ...
Run 1 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2400.3 MiB   2329.1 MiB           1       run_polars_query(parquet_files)


Memory = 2330.02 MB, Time = 19.02 s
Run 2 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2460.9 MiB   2389.8 MiB           1       run_polars_query(parquet_files)


Memory = 2390.70 MB, Time = 18.99 s
Run 3 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2547.7 MiB   2476.6 MiB           1       run_polars_query(parquet_files)


Memory = 2477.47 MB, Time = 18.58 s
Run 4 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.3 MiB     71.3 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1186.1 MiB   1114.8 MiB           1       run_polars_query(parquet_files)


Memory = 1115.73 MB, Time = 20.83 s
Run 5 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1948.5 MiB   1877.3 MiB           1       run_polars_query(parquet_files)


Memory = 1878.22 MB, Time = 20.02 s
Run 6 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.3 MiB     71.3 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2030.9 MiB   1959.7 MiB           1       run_polars_query(parquet_files)


Memory = 1960.62 MB, Time = 18.92 s
Run 7 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2209.1 MiB   2138.0 MiB           1       run_polars_query(parquet_files)


Memory = 2138.94 MB, Time = 18.90 s
Run 8 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2416.2 MiB   2345.0 MiB           1       run_polars_query(parquet_files)


Memory = 2346.02 MB, Time = 18.37 s
Run 9 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2596.1 MiB   2525.1 MiB           1       run_polars_query(parquet_files)


Memory = 2526.02 MB, Time = 18.45 s
Run 10 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2515.0 MiB   2443.9 MiB           1       run_polars_query(parquet_files)


Memory = 2444.89 MB, Time = 18.14 s

------------------------------------------------

[STRESS-BIG] Reading 6 files with ca. 824.94 GB ...
Run 1 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2519.6 MiB   2448.5 MiB           1       run_polars_query(parquet_files)


Memory = 2449.39 MB, Time = 30.07 s
Run 2 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2248.5 MiB   2177.3 MiB           1       run_polars_query(parquet_files)


Memory = 2178.30 MB, Time = 29.47 s
Run 3 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2715.6 MiB   2644.4 MiB           1       run_polars_query(parquet_files)


Memory = 2645.39 MB, Time = 30.20 s
Run 4 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2725.5 MiB   2654.3 MiB           1       run_polars_query(parquet_files)


Memory = 2655.30 MB, Time = 29.44 s
Run 5 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2723.6 MiB   2652.4 MiB           1       run_polars_query(parquet_files)


Memory = 2653.44 MB, Time = 29.33 s
Run 6 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1682.1 MiB   1611.0 MiB           1       run_polars_query(parquet_files)


Memory = 1611.89 MB, Time = 33.09 s
Run 7 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.3 MiB     71.3 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2400.7 MiB   2329.4 MiB           1       run_polars_query(parquet_files)


Memory = 2330.39 MB, Time = 30.95 s
Run 8 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2761.0 MiB   2689.8 MiB           1       run_polars_query(parquet_files)


Memory = 2690.77 MB, Time = 30.80 s
Run 9 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2651.5 MiB   2580.3 MiB           1       run_polars_query(parquet_files)


Memory = 2581.34 MB, Time = 31.53 s
Run 10 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2807.5 MiB   2736.5 MiB           1       run_polars_query(parquet_files)


Memory = 2737.38 MB, Time = 29.67 s

------------------------------------------------

[STRESS-BIG] Reading 8 files with ca. 1099.92 GB ...
Run 1 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.5 MiB     71.5 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.5 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2740.4 MiB   2668.9 MiB           1       run_polars_query(parquet_files)


Memory = 2669.78 MB, Time = 46.06 s
Run 2 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2760.3 MiB   2689.2 MiB           1       run_polars_query(parquet_files)


Memory = 2688.11 MB, Time = 41.63 s
Run 3 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2454.9 MiB   2383.8 MiB           1       run_polars_query(parquet_files)


Memory = 2384.70 MB, Time = 42.45 s
Run 4 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2800.9 MiB   2729.8 MiB           1       run_polars_query(parquet_files)


Memory = 2731.08 MB, Time = 42.10 s
Run 5 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2799.9 MiB   2728.8 MiB           1       run_polars_query(parquet_files)


Memory = 2729.70 MB, Time = 42.35 s
Run 6 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1233.6 MiB   1162.5 MiB           1       run_polars_query(parquet_files)


Memory = 1163.47 MB, Time = 45.20 s
Run 7 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2948.8 MiB   2877.9 MiB           1       run_polars_query(parquet_files)


Memory = 2878.86 MB, Time = 47.79 s
Run 8 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2926.8 MiB   2855.7 MiB           1       run_polars_query(parquet_files)


Memory = 2854.12 MB, Time = 40.48 s
Run 9 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   3111.2 MiB   3040.1 MiB           1       run_polars_query(parquet_files)


Memory = 3039.14 MB, Time = 39.74 s
Run 10 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   3052.3 MiB   2981.2 MiB           1       run_polars_query(parquet_files)


Memory = 2982.17 MB, Time = 42.93 s

------------------------------------------------

[STRESS-BIG] Reading 10 files with ca. 1374.90 GB ...
Run 1 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2968.7 MiB   2897.5 MiB           1       run_polars_query(parquet_files)


Memory = 2895.39 MB, Time = 54.09 s
Run 2 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.3 MiB     71.3 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.3 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2937.2 MiB   2865.8 MiB           1       run_polars_query(parquet_files)


Memory = 2865.36 MB, Time = 54.73 s
Run 3 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   3298.2 MiB   3226.9 MiB           1       run_polars_query(parquet_files)


Memory = 3227.92 MB, Time = 60.59 s
Run 4 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2842.9 MiB   2771.7 MiB           1       run_polars_query(parquet_files)


Memory = 2772.92 MB, Time = 54.13 s
Run 5 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2868.0 MiB   2796.7 MiB           1       run_polars_query(parquet_files)


Memory = 2797.66 MB, Time = 51.55 s
Run 6 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2969.1 MiB   2898.1 MiB           1       run_polars_query(parquet_files)


Memory = 2899.02 MB, Time = 53.29 s
Run 7 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.1 MiB     71.1 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.1 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   3085.9 MiB   3014.8 MiB           1       run_polars_query(parquet_files)


Memory = 3014.05 MB, Time = 54.89 s
Run 8 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   1580.3 MiB   1509.2 MiB           1       run_polars_query(parquet_files)


Memory = 1510.27 MB, Time = 57.13 s
Run 9 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.2 MiB     71.2 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.2 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2946.6 MiB   2875.4 MiB           1       run_polars_query(parquet_files)


Memory = 2876.42 MB, Time = 57.78 s
Run 10 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    26     71.0 MiB     71.0 MiB           1   @profile
    27                                         def stress_test(scale_factors: List[int]):
    28     71.0 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    29   2717.3 MiB   2646.3 MiB           1       run_polars_query(parquet_files)


Memory = 2647.36 MB, Time = 56.88 s

--- Elapsed Time (s) ---
Mean:   25.04
Std:    18.80
CV:     75.1%
Min:    4.63
Max:    55.51
Span:   50.88

------------------------------------------------

--- Memory Used (MB) ---
Mean:   2470.71
Std:    390.12
CV:     15.8%
Min:    1855.65
Max:    3050.95
Span:   1195.30

------------------------------------------------

[START] duckdb - normal

------------------------------------------------

[NORMAL] Reading a table with ca. 2.2 GB ...
Run 1 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    105.3 MiB     34.1 MiB           1       run_query([parquet_path])


Memory = 34.19 MB, Time = 0.13 s
Run 2 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    106.4 MiB     35.2 MiB           1       run_query([parquet_path])


Memory = 35.36 MB, Time = 0.09 s
Run 3 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    107.1 MiB     36.0 MiB           1       run_query([parquet_path])


Memory = 36.06 MB, Time = 0.09 s
Run 4 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    106.7 MiB     35.5 MiB           1       run_query([parquet_path])


Memory = 35.61 MB, Time = 0.10 s
Run 5 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    105.7 MiB     34.7 MiB           1       run_query([parquet_path])


Memory = 34.80 MB, Time = 0.09 s
Run 6 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    106.2 MiB     35.1 MiB           1       run_query([parquet_path])


Memory = 35.23 MB, Time = 0.09 s
Run 7 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    105.4 MiB     34.4 MiB           1       run_query([parquet_path])


Memory = 34.50 MB, Time = 0.09 s
Run 8 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    106.0 MiB     34.8 MiB           1       run_query([parquet_path])


Memory = 34.92 MB, Time = 0.09 s
Run 9 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    105.8 MiB     34.6 MiB           1       run_query([parquet_path])


Memory = 34.72 MB, Time = 0.09 s
Run 10 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    105.7 MiB     34.6 MiB           1       run_query([parquet_path])


Memory = 34.73 MB, Time = 0.09 s

------------------------------------------------

[NORMAL] Reading a table with ca. 4.4 GB ...
Run 1 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    126.1 MiB     55.0 MiB           1       run_query([parquet_path])


Memory = 55.12 MB, Time = 0.24 s
Run 2 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    127.1 MiB     56.1 MiB           1       run_query([parquet_path])


Memory = 56.22 MB, Time = 0.15 s
Run 3 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    126.3 MiB     55.2 MiB           1       run_query([parquet_path])


Memory = 55.34 MB, Time = 0.16 s
Run 4 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    127.1 MiB     56.0 MiB           1       run_query([parquet_path])


Memory = 56.14 MB, Time = 0.16 s
Run 5 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    126.8 MiB     55.6 MiB           1       run_query([parquet_path])


Memory = 55.72 MB, Time = 0.16 s
Run 6 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    126.8 MiB     55.8 MiB           1       run_query([parquet_path])


Memory = 55.92 MB, Time = 0.16 s
Run 7 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    126.4 MiB     55.3 MiB           1       run_query([parquet_path])


Memory = 55.45 MB, Time = 0.15 s
Run 8 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     70.7 MiB     70.7 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     70.7 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    126.5 MiB     55.8 MiB           1       run_query([parquet_path])


Memory = 55.86 MB, Time = 0.15 s
Run 9 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    126.1 MiB     54.9 MiB           1       run_query([parquet_path])


Memory = 55.05 MB, Time = 0.16 s
Run 10 / 10

------------------------------------------------

2281119
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    127.2 MiB     56.1 MiB           1       run_query([parquet_path])


Memory = 56.23 MB, Time = 0.16 s

------------------------------------------------

[NORMAL] Reading a table with ca. 8.8 GB ...
Run 1 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    167.1 MiB     95.9 MiB           1       run_query([parquet_path])


Memory = 96.05 MB, Time = 0.44 s
Run 2 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    168.2 MiB     97.0 MiB           1       run_query([parquet_path])


Memory = 97.16 MB, Time = 0.30 s
Run 3 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    168.2 MiB     97.1 MiB           1       run_query([parquet_path])


Memory = 97.17 MB, Time = 0.29 s
Run 4 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.3 MiB     71.3 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.3 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    168.2 MiB     96.9 MiB           1       run_query([parquet_path])


Memory = 97.02 MB, Time = 0.29 s
Run 5 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    168.3 MiB     97.2 MiB           1       run_query([parquet_path])


Memory = 97.28 MB, Time = 0.29 s
Run 6 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    168.9 MiB     97.9 MiB           1       run_query([parquet_path])


Memory = 97.98 MB, Time = 0.29 s
Run 7 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    168.6 MiB     97.4 MiB           1       run_query([parquet_path])


Memory = 97.55 MB, Time = 0.29 s
Run 8 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     70.8 MiB     70.8 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     70.8 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    168.4 MiB     97.6 MiB           1       run_query([parquet_path])


Memory = 97.69 MB, Time = 0.28 s
Run 9 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    167.5 MiB     96.4 MiB           1       run_query([parquet_path])


Memory = 96.48 MB, Time = 0.28 s
Run 10 / 10

------------------------------------------------

4565749
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    168.1 MiB     96.9 MiB           1       run_query([parquet_path])


Memory = 96.98 MB, Time = 0.29 s

------------------------------------------------

[NORMAL] Reading a table with ca. 17.6 GB ...
Run 1 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     70.9 MiB     70.9 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     70.9 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    242.7 MiB    171.8 MiB           1       run_query([parquet_path])


Memory = 171.91 MB, Time = 0.89 s
Run 2 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    243.5 MiB    172.4 MiB           1       run_query([parquet_path])


Memory = 172.48 MB, Time = 0.56 s
Run 3 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    244.2 MiB    173.2 MiB           1       run_query([parquet_path])


Memory = 173.33 MB, Time = 0.56 s
Run 4 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    243.6 MiB    172.4 MiB           1       run_query([parquet_path])


Memory = 172.50 MB, Time = 0.57 s
Run 5 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    244.6 MiB    173.6 MiB           1       run_query([parquet_path])


Memory = 173.75 MB, Time = 0.58 s
Run 6 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    243.9 MiB    172.8 MiB           1       run_query([parquet_path])


Memory = 172.88 MB, Time = 0.59 s
Run 7 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.4 MiB     71.4 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.4 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    244.1 MiB    172.7 MiB           1       run_query([parquet_path])


Memory = 172.81 MB, Time = 0.62 s
Run 8 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    244.2 MiB    173.0 MiB           1       run_query([parquet_path])


Memory = 173.16 MB, Time = 0.60 s
Run 9 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.4 MiB     71.4 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.4 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    245.7 MiB    174.3 MiB           1       run_query([parquet_path])


Memory = 174.39 MB, Time = 0.59 s
Run 10 / 10

------------------------------------------------

9135381
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    245.9 MiB    174.8 MiB           1       run_query([parquet_path])


Memory = 174.86 MB, Time = 0.60 s

------------------------------------------------

[NORMAL] Reading a table with ca. 35.2 GB ...
Run 1 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    413.0 MiB    341.9 MiB           1       run_query([parquet_path])


Memory = 342.02 MB, Time = 1.82 s
Run 2 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.3 MiB     71.3 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.3 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    411.4 MiB    340.1 MiB           1       run_query([parquet_path])


Memory = 340.23 MB, Time = 1.75 s
Run 3 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    411.0 MiB    339.9 MiB           1       run_query([parquet_path])


Memory = 340.08 MB, Time = 1.74 s
Run 4 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    411.7 MiB    340.6 MiB           1       run_query([parquet_path])


Memory = 340.70 MB, Time = 1.77 s
Run 5 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.3 MiB     71.3 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.3 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    411.5 MiB    340.2 MiB           1       run_query([parquet_path])


Memory = 340.33 MB, Time = 1.75 s
Run 6 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    411.7 MiB    340.5 MiB           1       run_query([parquet_path])


Memory = 340.59 MB, Time = 1.73 s
Run 7 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    411.5 MiB    340.5 MiB           1       run_query([parquet_path])


Memory = 340.62 MB, Time = 1.75 s
Run 8 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.3 MiB     71.3 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.3 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    410.9 MiB    339.6 MiB           1       run_query([parquet_path])


Memory = 339.70 MB, Time = 1.75 s
Run 9 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    410.7 MiB    339.5 MiB           1       run_query([parquet_path])


Memory = 339.64 MB, Time = 1.75 s
Run 10 / 10

------------------------------------------------

18269118
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     70.9 MiB     70.9 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     70.9 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    410.7 MiB    339.8 MiB           1       run_query([parquet_path])


Memory = 339.94 MB, Time = 1.75 s

------------------------------------------------

[NORMAL] Reading a table with ca. 70.4 GB ...
Run 1 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    736.8 MiB    665.7 MiB           1       run_query([parquet_path])


Memory = 665.81 MB, Time = 3.46 s
Run 2 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.3 MiB     71.3 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.3 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    737.1 MiB    665.8 MiB           1       run_query([parquet_path])


Memory = 665.92 MB, Time = 3.46 s
Run 3 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    736.6 MiB    665.4 MiB           1       run_query([parquet_path])


Memory = 665.53 MB, Time = 3.44 s
Run 4 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    737.0 MiB    665.8 MiB           1       run_query([parquet_path])


Memory = 665.92 MB, Time = 3.47 s
Run 5 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    736.4 MiB    665.3 MiB           1       run_query([parquet_path])


Memory = 665.41 MB, Time = 3.46 s
Run 6 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.4 MiB     71.4 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.4 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    736.9 MiB    665.5 MiB           1       run_query([parquet_path])


Memory = 665.62 MB, Time = 3.46 s
Run 7 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    738.1 MiB    666.9 MiB           1       run_query([parquet_path])


Memory = 667.03 MB, Time = 3.52 s
Run 8 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.2 MiB     71.2 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.2 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    736.9 MiB    665.7 MiB           1       run_query([parquet_path])


Memory = 665.83 MB, Time = 3.49 s
Run 9 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    736.9 MiB    665.8 MiB           1       run_query([parquet_path])


Memory = 665.95 MB, Time = 3.47 s
Run 10 / 10

------------------------------------------------

36542597
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23    737.1 MiB    666.0 MiB           1       run_query([parquet_path])


Memory = 666.16 MB, Time = 3.47 s

------------------------------------------------

[NORMAL] Reading a table with ca. 140.8 GB ...
Run 1 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23   1388.4 MiB   1317.3 MiB           1       run_query([parquet_path])


Memory = 1317.45 MB, Time = 5.53 s
Run 2 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23   1387.7 MiB   1316.7 MiB           1       run_query([parquet_path])


Memory = 1316.84 MB, Time = 4.91 s
Run 3 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.4 MiB     71.4 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.4 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23   1387.7 MiB   1316.3 MiB           1       run_query([parquet_path])


Memory = 1316.42 MB, Time = 4.98 s
Run 4 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.1 MiB     71.1 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.1 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23   1387.2 MiB   1316.1 MiB           1       run_query([parquet_path])


Memory = 1316.25 MB, Time = 5.02 s
Run 5 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.3 MiB     71.3 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.3 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23   1387.9 MiB   1316.6 MiB           1       run_query([parquet_path])


Memory = 1316.73 MB, Time = 5.00 s
Run 6 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23   1387.3 MiB   1316.2 MiB           1       run_query([parquet_path])


Memory = 1316.36 MB, Time = 5.04 s
Run 7 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.4 MiB     71.4 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.4 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23   1388.2 MiB   1316.8 MiB           1       run_query([parquet_path])


Memory = 1316.89 MB, Time = 5.08 s
Run 8 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.3 MiB     71.3 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.3 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23   1387.6 MiB   1316.3 MiB           1       run_query([parquet_path])


Memory = 1316.42 MB, Time = 5.06 s
Run 9 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.0 MiB     71.0 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.0 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23   1387.6 MiB   1316.6 MiB           1       run_query([parquet_path])


Memory = 1316.70 MB, Time = 5.07 s
Run 10 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    20     71.3 MiB     71.3 MiB           1   @profile
    21                                         def normal_test(scale_factor: int):
    22     71.3 MiB      0.0 MiB           1       parquet_path = f"tpc/lineitem_{scale_factor}.parquet"
    23   1387.8 MiB   1316.6 MiB           1       run_query([parquet_path])


Memory = 1316.67 MB, Time = 5.10 s

--- Elapsed Time (s) ---
Mean:   1.64
Std:    1.94
CV:     118.3%
Min:    0.10
Max:    5.08
Span:   4.98

------------------------------------------------

--- Memory Used (MB) ---
Mean:   383.43
Std:    466.82
CV:     121.7%
Min:    35.01
Max:    1316.67
Span:   1281.66

------------------------------------------------

[START] duckdb - stress-small

------------------------------------------------

[STRESS-SMALL] Reading 1 files with ca. 2.06 GB ...
Run 1 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    104.7 MiB     33.6 MiB           1       run_query(parquet_files)


Memory = 33.72 MB, Time = 0.13 s
Run 2 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    106.4 MiB     35.4 MiB           1       run_query(parquet_files)


Memory = 35.52 MB, Time = 0.09 s
Run 3 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    106.2 MiB     35.0 MiB           1       run_query(parquet_files)


Memory = 35.16 MB, Time = 0.09 s
Run 4 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    106.4 MiB     35.3 MiB           1       run_query(parquet_files)


Memory = 35.38 MB, Time = 0.09 s
Run 5 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    106.9 MiB     35.8 MiB           1       run_query(parquet_files)


Memory = 35.95 MB, Time = 0.09 s
Run 6 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    106.5 MiB     35.5 MiB           1       run_query(parquet_files)


Memory = 35.58 MB, Time = 0.09 s
Run 7 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    106.0 MiB     34.9 MiB           1       run_query(parquet_files)


Memory = 34.98 MB, Time = 0.09 s
Run 8 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    105.5 MiB     34.4 MiB           1       run_query(parquet_files)


Memory = 34.55 MB, Time = 0.09 s
Run 9 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    105.8 MiB     34.8 MiB           1       run_query(parquet_files)


Memory = 34.91 MB, Time = 0.09 s
Run 10 / 10

------------------------------------------------

1139264
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    106.0 MiB     35.0 MiB           1       run_query(parquet_files)


Memory = 35.11 MB, Time = 0.09 s

------------------------------------------------

[STRESS-SMALL] Reading 2 files with ca. 4.12 GB ...
Run 1 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.4 MiB     71.4 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.4 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    113.5 MiB     42.0 MiB           1       run_query(parquet_files)


Memory = 42.16 MB, Time = 0.15 s
Run 2 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.6 MiB     71.6 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.6 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    113.0 MiB     41.5 MiB           1       run_query(parquet_files)


Memory = 41.56 MB, Time = 0.15 s
Run 3 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    114.0 MiB     43.0 MiB           1       run_query(parquet_files)


Memory = 43.08 MB, Time = 0.15 s
Run 4 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    112.9 MiB     41.9 MiB           1       run_query(parquet_files)


Memory = 42.03 MB, Time = 0.15 s
Run 5 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    113.6 MiB     42.5 MiB           1       run_query(parquet_files)


Memory = 42.56 MB, Time = 0.15 s
Run 6 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    113.8 MiB     42.6 MiB           1       run_query(parquet_files)


Memory = 42.72 MB, Time = 0.15 s
Run 7 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.3 MiB     71.3 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.3 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    113.8 MiB     42.5 MiB           1       run_query(parquet_files)


Memory = 42.61 MB, Time = 0.15 s
Run 8 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.3 MiB     71.3 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.3 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    113.3 MiB     42.0 MiB           1       run_query(parquet_files)


Memory = 42.09 MB, Time = 0.15 s
Run 9 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     70.8 MiB     70.8 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     70.8 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    113.6 MiB     42.8 MiB           1       run_query(parquet_files)


Memory = 42.97 MB, Time = 0.15 s
Run 10 / 10

------------------------------------------------

2278528
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.3 MiB     71.3 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.3 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    113.1 MiB     41.7 MiB           1       run_query(parquet_files)


Memory = 41.83 MB, Time = 0.15 s

------------------------------------------------

[STRESS-SMALL] Reading 4 files with ca. 8.24 GB ...
Run 1 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    127.1 MiB     56.1 MiB           1       run_query(parquet_files)


Memory = 56.19 MB, Time = 0.26 s
Run 2 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     70.7 MiB     70.7 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     70.7 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    128.2 MiB     57.5 MiB           1       run_query(parquet_files)


Memory = 57.59 MB, Time = 0.27 s
Run 3 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    127.1 MiB     56.0 MiB           1       run_query(parquet_files)


Memory = 56.09 MB, Time = 0.26 s
Run 4 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    127.5 MiB     56.5 MiB           1       run_query(parquet_files)


Memory = 56.66 MB, Time = 0.26 s
Run 5 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    127.3 MiB     56.2 MiB           1       run_query(parquet_files)


Memory = 56.31 MB, Time = 0.26 s
Run 6 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.3 MiB     71.3 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.3 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    129.0 MiB     57.7 MiB           1       run_query(parquet_files)


Memory = 57.78 MB, Time = 0.26 s
Run 7 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    127.2 MiB     56.0 MiB           1       run_query(parquet_files)


Memory = 56.06 MB, Time = 0.26 s
Run 8 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    127.2 MiB     56.2 MiB           1       run_query(parquet_files)


Memory = 56.33 MB, Time = 0.26 s
Run 9 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    127.3 MiB     56.1 MiB           1       run_query(parquet_files)


Memory = 56.23 MB, Time = 0.26 s
Run 10 / 10

------------------------------------------------

4557056
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    126.8 MiB     55.8 MiB           1       run_query(parquet_files)


Memory = 55.88 MB, Time = 0.26 s

------------------------------------------------

[STRESS-SMALL] Reading 8 files with ca. 16.48 GB ...
Run 1 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     70.9 MiB     70.9 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     70.9 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    155.2 MiB     84.3 MiB           1       run_query(parquet_files)


Memory = 84.45 MB, Time = 0.49 s
Run 2 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    154.1 MiB     83.0 MiB           1       run_query(parquet_files)


Memory = 83.16 MB, Time = 0.47 s
Run 3 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     70.8 MiB     70.8 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     70.8 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    154.7 MiB     83.9 MiB           1       run_query(parquet_files)


Memory = 84.03 MB, Time = 0.49 s
Run 4 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    154.5 MiB     83.5 MiB           1       run_query(parquet_files)


Memory = 83.59 MB, Time = 0.48 s
Run 5 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    154.6 MiB     83.6 MiB           1       run_query(parquet_files)


Memory = 83.67 MB, Time = 0.48 s
Run 6 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    154.9 MiB     83.8 MiB           1       run_query(parquet_files)


Memory = 83.89 MB, Time = 0.49 s
Run 7 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    155.5 MiB     84.3 MiB           1       run_query(parquet_files)


Memory = 84.41 MB, Time = 0.48 s
Run 8 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    154.5 MiB     83.3 MiB           1       run_query(parquet_files)


Memory = 83.42 MB, Time = 0.49 s
Run 9 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    154.7 MiB     83.5 MiB           1       run_query(parquet_files)


Memory = 83.55 MB, Time = 0.48 s
Run 10 / 10

------------------------------------------------

9114112
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.3 MiB     71.3 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.3 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    154.6 MiB     83.3 MiB           1       run_query(parquet_files)


Memory = 83.42 MB, Time = 0.47 s

------------------------------------------------

[STRESS-SMALL] Reading 18 files with ca. 37.08 GB ...
Run 1 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    176.0 MiB    104.8 MiB           1       run_query(parquet_files)


Memory = 104.95 MB, Time = 1.04 s
Run 2 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    175.8 MiB    104.6 MiB           1       run_query(parquet_files)


Memory = 104.67 MB, Time = 1.03 s
Run 3 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    176.0 MiB    104.8 MiB           1       run_query(parquet_files)


Memory = 104.92 MB, Time = 1.02 s
Run 4 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    175.4 MiB    104.5 MiB           1       run_query(parquet_files)


Memory = 104.56 MB, Time = 1.03 s
Run 5 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.3 MiB     71.3 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.3 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    175.1 MiB    103.8 MiB           1       run_query(parquet_files)


Memory = 103.89 MB, Time = 1.03 s
Run 6 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    175.8 MiB    104.7 MiB           1       run_query(parquet_files)


Memory = 104.83 MB, Time = 1.03 s
Run 7 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    175.8 MiB    104.8 MiB           1       run_query(parquet_files)


Memory = 104.88 MB, Time = 1.02 s
Run 8 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    175.2 MiB    104.0 MiB           1       run_query(parquet_files)


Memory = 104.06 MB, Time = 1.04 s
Run 9 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    175.1 MiB    104.1 MiB           1       run_query(parquet_files)


Memory = 104.22 MB, Time = 1.05 s
Run 10 / 10

------------------------------------------------

20506752
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB          19       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    175.7 MiB    104.5 MiB           1       run_query(parquet_files)


Memory = 104.59 MB, Time = 1.05 s

------------------------------------------------

[STRESS-SMALL] Reading 36 files with ca. 74.16 GB ...
Run 1 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     70.8 MiB     70.8 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     70.8 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    180.8 MiB    110.0 MiB           1       run_query(parquet_files)


Memory = 110.12 MB, Time = 1.99 s
Run 2 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     70.9 MiB     70.9 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     70.9 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    175.6 MiB    104.7 MiB           1       run_query(parquet_files)


Memory = 104.80 MB, Time = 2.00 s
Run 3 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    192.0 MiB    120.8 MiB           1       run_query(parquet_files)


Memory = 120.89 MB, Time = 2.03 s
Run 4 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.3 MiB     71.3 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.3 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    176.3 MiB    105.0 MiB           1       run_query(parquet_files)


Memory = 105.12 MB, Time = 2.08 s
Run 5 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    177.6 MiB    106.5 MiB           1       run_query(parquet_files)


Memory = 106.61 MB, Time = 2.13 s
Run 6 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     70.8 MiB     70.8 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     70.8 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    177.2 MiB    106.4 MiB           1       run_query(parquet_files)


Memory = 106.52 MB, Time = 2.17 s
Run 7 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    191.3 MiB    120.2 MiB           1       run_query(parquet_files)


Memory = 120.33 MB, Time = 2.08 s
Run 8 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.6 MiB     71.6 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.6 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    176.1 MiB    104.4 MiB           1       run_query(parquet_files)


Memory = 104.55 MB, Time = 2.09 s
Run 9 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    178.7 MiB    107.7 MiB           1       run_query(parquet_files)


Memory = 107.78 MB, Time = 2.07 s
Run 10 / 10

------------------------------------------------

41013504
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB          37       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    193.4 MiB    122.3 MiB           1       run_query(parquet_files)


Memory = 122.45 MB, Time = 2.10 s

------------------------------------------------

[STRESS-SMALL] Reading 72 files with ca. 148.32 GB ...
Run 1 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.4 MiB     71.4 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.4 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    177.4 MiB    106.0 MiB           1       run_query(parquet_files)


Memory = 106.09 MB, Time = 4.21 s
Run 2 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    180.5 MiB    109.3 MiB           1       run_query(parquet_files)


Memory = 109.41 MB, Time = 4.10 s
Run 3 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    176.9 MiB    105.7 MiB           1       run_query(parquet_files)


Memory = 105.83 MB, Time = 4.08 s
Run 4 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    178.0 MiB    106.8 MiB           1       run_query(parquet_files)


Memory = 106.97 MB, Time = 4.03 s
Run 5 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.4 MiB     71.4 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.4 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    180.5 MiB    109.1 MiB           1       run_query(parquet_files)


Memory = 109.19 MB, Time = 4.13 s
Run 6 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.5 MiB     71.5 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.5 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    183.2 MiB    111.8 MiB           1       run_query(parquet_files)


Memory = 111.89 MB, Time = 4.07 s
Run 7 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.4 MiB     71.4 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.4 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    177.0 MiB    105.5 MiB           1       run_query(parquet_files)


Memory = 105.67 MB, Time = 4.07 s
Run 8 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.5 MiB     71.5 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.5 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    182.3 MiB    110.8 MiB           1       run_query(parquet_files)


Memory = 110.95 MB, Time = 4.38 s
Run 9 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    192.7 MiB    121.4 MiB           1       run_query(parquet_files)


Memory = 121.52 MB, Time = 4.11 s
Run 10 / 10

------------------------------------------------

82027008
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     70.7 MiB     70.7 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     70.7 MiB      0.0 MiB          73       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28    178.6 MiB    107.9 MiB           1       run_query(parquet_files)


Memory = 108.05 MB, Time = 4.01 s

--- Elapsed Time (s) ---
Mean:   1.17
Std:    1.47
CV:     125.6%
Min:    0.09
Max:    4.12
Span:   4.02

------------------------------------------------

--- Memory Used (MB) ---
Mean:   77.54
Std:    32.63
CV:     42.1%
Min:    35.09
Max:    110.92
Span:   75.83

------------------------------------------------

[START] duckdb - stress-big

------------------------------------------------

[STRESS-BIG] Reading 1 files with ca. 137.49 GB ...
Run 1 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1387.2 MiB   1316.2 MiB           1       run_query(parquet_files)


Memory = 1316.27 MB, Time = 5.15 s
Run 2 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1387.5 MiB   1316.4 MiB           1       run_query(parquet_files)


Memory = 1316.50 MB, Time = 5.18 s
Run 3 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1387.0 MiB   1315.9 MiB           1       run_query(parquet_files)


Memory = 1316.00 MB, Time = 5.16 s
Run 4 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.4 MiB     71.4 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.4 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1387.3 MiB   1315.9 MiB           1       run_query(parquet_files)


Memory = 1316.02 MB, Time = 5.27 s
Run 5 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1387.3 MiB   1316.2 MiB           1       run_query(parquet_files)


Memory = 1316.34 MB, Time = 5.20 s
Run 6 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1387.9 MiB   1316.8 MiB           1       run_query(parquet_files)


Memory = 1316.92 MB, Time = 5.69 s
Run 7 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     70.7 MiB     70.7 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     70.7 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1387.1 MiB   1316.4 MiB           1       run_query(parquet_files)


Memory = 1316.48 MB, Time = 5.35 s
Run 8 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1387.3 MiB   1316.3 MiB           1       run_query(parquet_files)


Memory = 1316.45 MB, Time = 5.26 s
Run 9 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1387.2 MiB   1316.1 MiB           1       run_query(parquet_files)


Memory = 1316.19 MB, Time = 5.42 s
Run 10 / 10

------------------------------------------------

73100039
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           2       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1387.0 MiB   1315.8 MiB           1       run_query(parquet_files)


Memory = 1315.94 MB, Time = 5.28 s

------------------------------------------------

[STRESS-BIG] Reading 2 files with ca. 274.98 GB ...
Run 1 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1812.0 MiB   1740.8 MiB           1       run_query(parquet_files)


Memory = 1740.95 MB, Time = 9.93 s
Run 2 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1810.8 MiB   1739.8 MiB           1       run_query(parquet_files)


Memory = 1739.88 MB, Time = 9.92 s
Run 3 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1812.1 MiB   1741.0 MiB           1       run_query(parquet_files)


Memory = 1741.06 MB, Time = 9.85 s
Run 4 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1812.3 MiB   1741.3 MiB           1       run_query(parquet_files)


Memory = 1741.42 MB, Time = 9.61 s
Run 5 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1812.0 MiB   1740.8 MiB           1       run_query(parquet_files)


Memory = 1740.88 MB, Time = 9.86 s
Run 6 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     70.7 MiB     70.7 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     70.7 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1811.6 MiB   1740.9 MiB           1       run_query(parquet_files)


Memory = 1741.03 MB, Time = 9.78 s
Run 7 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1811.5 MiB   1740.4 MiB           1       run_query(parquet_files)


Memory = 1740.47 MB, Time = 9.81 s
Run 8 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1811.7 MiB   1740.5 MiB           1       run_query(parquet_files)


Memory = 1740.58 MB, Time = 9.92 s
Run 9 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1811.1 MiB   1739.9 MiB           1       run_query(parquet_files)


Memory = 1740.02 MB, Time = 9.69 s
Run 10 / 10

------------------------------------------------

146200078
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           3       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   1811.5 MiB   1740.5 MiB           1       run_query(parquet_files)


Memory = 1740.59 MB, Time = 9.66 s

------------------------------------------------

[STRESS-BIG] Reading 3 files with ca. 412.47 GB ...
Run 1 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2186.6 MiB   2115.4 MiB           1       run_query(parquet_files)


Memory = 2115.52 MB, Time = 13.53 s
Run 2 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2185.7 MiB   2114.5 MiB           1       run_query(parquet_files)


Memory = 2114.58 MB, Time = 13.08 s
Run 3 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.3 MiB     71.3 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.3 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2185.6 MiB   2114.4 MiB           1       run_query(parquet_files)


Memory = 2114.47 MB, Time = 13.07 s
Run 4 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2186.3 MiB   2115.2 MiB           1       run_query(parquet_files)


Memory = 2115.33 MB, Time = 12.98 s
Run 5 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2185.8 MiB   2114.5 MiB           1       run_query(parquet_files)


Memory = 2114.66 MB, Time = 12.06 s
Run 6 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2183.9 MiB   2112.9 MiB           1       run_query(parquet_files)


Memory = 2113.03 MB, Time = 12.13 s
Run 7 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2184.2 MiB   2113.0 MiB           1       run_query(parquet_files)


Memory = 2113.06 MB, Time = 12.09 s
Run 8 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.3 MiB     71.3 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.3 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2185.5 MiB   2114.1 MiB           1       run_query(parquet_files)


Memory = 2114.23 MB, Time = 12.17 s
Run 9 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2185.2 MiB   2114.1 MiB           1       run_query(parquet_files)


Memory = 2114.22 MB, Time = 11.77 s
Run 10 / 10

------------------------------------------------

219300117
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           4       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2185.0 MiB   2114.0 MiB           1       run_query(parquet_files)


Memory = 2114.05 MB, Time = 11.81 s

------------------------------------------------

[STRESS-BIG] Reading 4 files with ca. 549.96 GB ...
Run 1 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2657.1 MiB   2586.1 MiB           1       run_query(parquet_files)


Memory = 2586.23 MB, Time = 15.46 s
Run 2 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2657.8 MiB   2586.6 MiB           1       run_query(parquet_files)


Memory = 2586.75 MB, Time = 15.47 s
Run 3 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.4 MiB     71.4 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.4 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2658.3 MiB   2586.9 MiB           1       run_query(parquet_files)


Memory = 2586.97 MB, Time = 16.51 s
Run 4 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2658.0 MiB   2586.8 MiB           1       run_query(parquet_files)


Memory = 2586.89 MB, Time = 16.13 s
Run 5 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2658.4 MiB   2587.2 MiB           1       run_query(parquet_files)


Memory = 2587.28 MB, Time = 15.72 s
Run 6 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2659.0 MiB   2587.9 MiB           1       run_query(parquet_files)


Memory = 2587.97 MB, Time = 15.50 s
Run 7 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2657.0 MiB   2586.0 MiB           1       run_query(parquet_files)


Memory = 2586.17 MB, Time = 15.26 s
Run 8 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2658.5 MiB   2587.3 MiB           1       run_query(parquet_files)


Memory = 2587.45 MB, Time = 15.33 s
Run 9 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.3 MiB     71.3 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.3 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2659.0 MiB   2587.7 MiB           1       run_query(parquet_files)


Memory = 2587.78 MB, Time = 15.30 s
Run 10 / 10

------------------------------------------------

292400156
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           5       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   2657.6 MiB   2586.5 MiB           1       run_query(parquet_files)


Memory = 2586.64 MB, Time = 15.27 s

------------------------------------------------

[STRESS-BIG] Reading 6 files with ca. 824.94 GB ...
Run 1 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   3497.0 MiB   3425.9 MiB           1       run_query(parquet_files)


Memory = 3426.02 MB, Time = 22.97 s
Run 2 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   3497.4 MiB   3426.4 MiB           1       run_query(parquet_files)


Memory = 3426.52 MB, Time = 23.85 s
Run 3 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.3 MiB     71.3 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.3 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   3497.4 MiB   3426.1 MiB           1       run_query(parquet_files)


Memory = 3426.23 MB, Time = 24.28 s
Run 4 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   3498.7 MiB   3427.5 MiB           1       run_query(parquet_files)


Memory = 3427.67 MB, Time = 23.27 s
Run 5 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.3 MiB     71.3 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.3 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   3497.0 MiB   3425.7 MiB           1       run_query(parquet_files)


Memory = 3425.80 MB, Time = 23.38 s
Run 6 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   3498.2 MiB   3427.1 MiB           1       run_query(parquet_files)


Memory = 3427.23 MB, Time = 25.31 s
Run 7 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   3497.8 MiB   3426.7 MiB           1       run_query(parquet_files)


Memory = 3426.80 MB, Time = 23.57 s
Run 8 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   3501.7 MiB   3430.6 MiB           1       run_query(parquet_files)


Memory = 3430.72 MB, Time = 23.90 s
Run 9 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   3499.1 MiB   3428.0 MiB           1       run_query(parquet_files)


Memory = 3428.09 MB, Time = 24.84 s
Run 10 / 10

------------------------------------------------

438600234
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           7       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   3497.9 MiB   3426.8 MiB           1       run_query(parquet_files)


Memory = 3426.97 MB, Time = 23.98 s

------------------------------------------------

[STRESS-BIG] Reading 8 files with ca. 1099.92 GB ...
Run 1 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   4332.6 MiB   4261.5 MiB           1       run_query(parquet_files)


Memory = 4261.59 MB, Time = 33.62 s
Run 2 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   4335.7 MiB   4264.7 MiB           1       run_query(parquet_files)


Memory = 4264.80 MB, Time = 33.04 s
Run 3 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   4336.8 MiB   4265.7 MiB           1       run_query(parquet_files)


Memory = 4265.80 MB, Time = 33.12 s
Run 4 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   4337.7 MiB   4266.5 MiB           1       run_query(parquet_files)


Memory = 4266.61 MB, Time = 33.55 s
Run 5 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.3 MiB     71.3 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.3 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   4337.2 MiB   4265.8 MiB           1       run_query(parquet_files)


Memory = 4265.95 MB, Time = 33.81 s
Run 6 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   4320.1 MiB   4248.9 MiB           1       run_query(parquet_files)


Memory = 4249.00 MB, Time = 33.75 s
Run 7 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.5 MiB     71.5 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.5 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   4335.2 MiB   4263.7 MiB           1       run_query(parquet_files)


Memory = 4263.81 MB, Time = 34.37 s
Run 8 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   4330.8 MiB   4259.6 MiB           1       run_query(parquet_files)


Memory = 4259.70 MB, Time = 35.04 s
Run 9 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   4336.0 MiB   4264.8 MiB           1       run_query(parquet_files)


Memory = 4264.95 MB, Time = 33.80 s
Run 10 / 10

------------------------------------------------

584800312
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.6 MiB     71.6 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.6 MiB      0.0 MiB           9       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   4337.6 MiB   4266.0 MiB           1       run_query(parquet_files)


Memory = 4266.14 MB, Time = 33.78 s

------------------------------------------------

[STRESS-BIG] Reading 10 files with ca. 1374.90 GB ...
Run 1 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   5171.2 MiB   5100.0 MiB           1       run_query(parquet_files)


Memory = 5100.09 MB, Time = 43.10 s
Run 2 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   5177.3 MiB   5106.2 MiB           1       run_query(parquet_files)


Memory = 5106.34 MB, Time = 42.96 s
Run 3 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   5174.4 MiB   5103.4 MiB           1       run_query(parquet_files)


Memory = 5103.47 MB, Time = 43.18 s
Run 4 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   5171.1 MiB   5100.1 MiB           1       run_query(parquet_files)


Memory = 5100.17 MB, Time = 42.81 s
Run 5 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.3 MiB     71.3 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.3 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   5174.6 MiB   5103.3 MiB           1       run_query(parquet_files)


Memory = 5103.39 MB, Time = 44.52 s
Run 6 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   5155.8 MiB   5084.6 MiB           1       run_query(parquet_files)


Memory = 5084.75 MB, Time = 48.27 s
Run 7 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.2 MiB     71.2 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.2 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   5177.2 MiB   5106.0 MiB           1       run_query(parquet_files)


Memory = 5106.09 MB, Time = 46.84 s
Run 8 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   5179.5 MiB   5108.4 MiB           1       run_query(parquet_files)


Memory = 5108.48 MB, Time = 44.67 s
Run 9 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.0 MiB     71.0 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.0 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   5174.9 MiB   5103.9 MiB           1       run_query(parquet_files)


Memory = 5104.00 MB, Time = 44.42 s
Run 10 / 10

------------------------------------------------

731000390
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_stresstest/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    25     71.1 MiB     71.1 MiB           1   @profile
    26                                         def stress_test(scale_factors: List[int]):
    27     71.1 MiB      0.0 MiB          11       parquet_files = [f"tpc/lineitem_{sf}.parquet" for sf in scale_factors]
    28   5174.9 MiB   5103.9 MiB           1       run_query(parquet_files)


Memory = 5103.97 MB, Time = 44.80 s

--- Elapsed Time (s) ---
Mean:   20.78
Std:    14.15
CV:     68.1%
Min:    5.30
Max:    44.56
Span:   39.26

------------------------------------------------

--- Memory Used (MB) ---
Mean:   2935.78
Std:    1387.01
CV:     47.2%
Min:    1316.31
Max:    5102.07
Span:   3785.76

------------------------------------------------

=== Phase 2: Plotting figures (saving to disk) ===
Plot saved to results/polars_duckdb_normal_memory.png
Plot saved to results/polars_duckdb_normal_time.png
Plot saved to results/polars_duckdb_stress-small_memory.png
Plot saved to results/polars_duckdb_stress-small_time.png
Plot saved to results/polars_duckdb_stress-big_memory.png
Plot saved to results/polars_duckdb_stress-big_time.png
Overlay plot saved to results/polars_duckdb_overlay_memory.png
Overlay plot saved to results/polars_duckdb_overlay_time.png
