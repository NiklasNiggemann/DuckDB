
=== Phase 1: Running benchmarks ===

[RUN] filtering_counting | cold | pandas

------------------------------------------------

*** Run 1/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.5 MiB    142.5 MiB           1   @profile
     8                                         def filtering_counting():
     9  10915.0 MiB  10772.5 MiB           1       df = pd.read_csv(dataset_path)
    10  12433.7 MiB   1518.7 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  12433.9 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = 11156.84 MB, Time = 60.16 s

------------------------------------------------

*** Run 2/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.3 MiB    142.3 MiB           1   @profile
     8                                         def filtering_counting():
     9   8903.0 MiB   8760.7 MiB           1       df = pd.read_csv(dataset_path)
    10  11164.2 MiB   2261.2 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  11164.3 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = 9051.72 MB, Time = 61.02 s

------------------------------------------------

*** Run 3/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.5 MiB    142.5 MiB           1   @profile
     8                                         def filtering_counting():
     9   9745.7 MiB   9603.2 MiB           1       df = pd.read_csv(dataset_path)
    10  11276.8 MiB   1531.1 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  11277.0 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = 10272.75 MB, Time = 60.97 s

------------------------------------------------

*** Run 4/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.5 MiB    142.5 MiB           1   @profile
     8                                         def filtering_counting():
     9   9465.7 MiB   9323.2 MiB           1       df = pd.read_csv(dataset_path)
    10  11269.6 MiB   1804.0 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  11269.8 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = 10286.62 MB, Time = 60.04 s

------------------------------------------------

*** Run 5/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.6 MiB    142.6 MiB           1   @profile
     8                                         def filtering_counting():
     9   9131.4 MiB   8988.7 MiB           1       df = pd.read_csv(dataset_path)
    10  11119.6 MiB   1988.2 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  11119.7 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = 10122.91 MB, Time = 59.39 s

------------------------------------------------

*** Run 6/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.8 MiB    142.8 MiB           1   @profile
     8                                         def filtering_counting():
     9   8942.0 MiB   8799.2 MiB           1       df = pd.read_csv(dataset_path)
    10  11106.5 MiB   2164.6 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  11106.7 MiB      0.2 MiB           1       print("Count:", len(purchases))


Memory = 9631.41 MB, Time = 61.36 s

------------------------------------------------

*** Run 7/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    143.1 MiB    143.1 MiB           1   @profile
     8                                         def filtering_counting():
     9   8659.6 MiB   8516.5 MiB           1       df = pd.read_csv(dataset_path)
    10  11516.4 MiB   2856.8 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  11516.6 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = 10507.69 MB, Time = 62.42 s

------------------------------------------------

*** Run 8/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.6 MiB    142.6 MiB           1   @profile
     8                                         def filtering_counting():
     9   8828.7 MiB   8686.1 MiB           1       df = pd.read_csv(dataset_path)
    10  10887.5 MiB   2058.8 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  10887.7 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = 8868.25 MB, Time = 60.80 s

------------------------------------------------

*** Run 9/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.4 MiB    142.4 MiB           1   @profile
     8                                         def filtering_counting():
     9   8747.1 MiB   8604.8 MiB           1       df = pd.read_csv(dataset_path)
    10  10946.8 MiB   2199.7 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  10947.0 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = 9501.86 MB, Time = 60.54 s

------------------------------------------------

*** Run 10/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.3 MiB    142.3 MiB           1   @profile
     8                                         def filtering_counting():
     9   8891.0 MiB   8748.6 MiB           1       df = pd.read_csv(dataset_path)
    10  11129.4 MiB   2238.4 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  11129.5 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = 9518.44 MB, Time = 60.65 s

--- Elapsed Time (s) ---
Mean:   60.73
Std:    0.82
CV:     1.3%
Min:    59.39
Max:    62.42
Span:   3.03

--- Memory Used (MB) ---
Mean:   9891.85
Std:    702.91
CV:     7.1%
Min:    8868.25
Max:    11156.84
Span:   2288.59

[RUN] filtering_counting | cold | duckdb

------------------------------------------------

*** Run 1/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.5 MiB    142.5 MiB           1   @profile
     8                                         def filtering_counting():
     9    459.2 MiB    316.7 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 316.92 MB, Time = 2.44 s

------------------------------------------------

*** Run 2/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.8 MiB    142.8 MiB           1   @profile
     8                                         def filtering_counting():
     9    370.9 MiB    228.1 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 228.33 MB, Time = 2.13 s

------------------------------------------------

*** Run 3/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.6 MiB    142.6 MiB           1   @profile
     8                                         def filtering_counting():
     9    489.4 MiB    346.8 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 346.98 MB, Time = 2.17 s

------------------------------------------------

*** Run 4/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.5 MiB    142.5 MiB           1   @profile
     8                                         def filtering_counting():
     9    672.9 MiB    530.4 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 530.64 MB, Time = 2.19 s

------------------------------------------------

*** Run 5/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.4 MiB    142.4 MiB           1   @profile
     8                                         def filtering_counting():
     9    825.6 MiB    683.2 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 683.42 MB, Time = 2.21 s

------------------------------------------------

*** Run 6/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.7 MiB    142.7 MiB           1   @profile
     8                                         def filtering_counting():
     9    367.5 MiB    224.9 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 225.08 MB, Time = 2.08 s

------------------------------------------------

*** Run 7/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.5 MiB    142.5 MiB           1   @profile
     8                                         def filtering_counting():
     9    520.1 MiB    377.6 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 377.81 MB, Time = 2.27 s

------------------------------------------------

*** Run 8/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.8 MiB    142.8 MiB           1   @profile
     8                                         def filtering_counting():
     9    550.9 MiB    408.1 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 408.38 MB, Time = 2.25 s

------------------------------------------------

*** Run 9/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.7 MiB    142.7 MiB           1   @profile
     8                                         def filtering_counting():
     9    734.1 MiB    591.4 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 591.58 MB, Time = 2.26 s

------------------------------------------------

*** Run 10/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.3 MiB    142.3 MiB           1   @profile
     8                                         def filtering_counting():
     9    458.9 MiB    316.6 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 316.81 MB, Time = 2.28 s

--- Elapsed Time (s) ---
Mean:   2.23
Std:    0.10
CV:     4.4%
Min:    2.08
Max:    2.44
Span:   0.36

--- Memory Used (MB) ---
Mean:   402.60
Std:    153.22
CV:     38.1%
Min:    225.08
Max:    683.42
Span:   458.34

[RUN] filtering_counting | cold | polars

------------------------------------------------

*** Run 1/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    143.2 MiB    143.2 MiB           1   @profile
     8                                         def filtering_counting():
     9    143.6 MiB      0.4 MiB           1       lf = pl.scan_csv(dataset_path)
    10   1629.9 MiB   1486.3 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   1630.2 MiB      0.2 MiB           1       print(result)


Memory = 1487.17 MB, Time = 3.11 s

------------------------------------------------

*** Run 2/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.7 MiB    142.7 MiB           1   @profile
     8                                         def filtering_counting():
     9    143.1 MiB      0.4 MiB           1       lf = pl.scan_csv(dataset_path)
    10   1657.8 MiB   1514.7 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   1658.1 MiB      0.3 MiB           1       print(result)


Memory = 1515.58 MB, Time = 2.98 s

------------------------------------------------

*** Run 3/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.7 MiB    142.7 MiB           1   @profile
     8                                         def filtering_counting():
     9    143.0 MiB      0.4 MiB           1       lf = pl.scan_csv(dataset_path)
    10   1610.9 MiB   1467.8 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   1611.1 MiB      0.2 MiB           1       print(result)


Memory = 1468.69 MB, Time = 3.10 s

------------------------------------------------

*** Run 4/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.6 MiB    142.6 MiB           1   @profile
     8                                         def filtering_counting():
     9    143.0 MiB      0.4 MiB           1       lf = pl.scan_csv(dataset_path)
    10   1627.9 MiB   1484.9 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   1628.2 MiB      0.2 MiB           1       print(result)


Memory = 1485.81 MB, Time = 3.00 s

------------------------------------------------

*** Run 5/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.6 MiB    142.6 MiB           1   @profile
     8                                         def filtering_counting():
     9    143.0 MiB      0.4 MiB           1       lf = pl.scan_csv(dataset_path)
    10   1738.6 MiB   1595.6 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   1738.9 MiB      0.3 MiB           1       print(result)


Memory = 1596.50 MB, Time = 2.82 s

------------------------------------------------

*** Run 6/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.3 MiB    142.3 MiB           1   @profile
     8                                         def filtering_counting():
     9    142.7 MiB      0.4 MiB           1       lf = pl.scan_csv(dataset_path)
    10   1488.6 MiB   1345.9 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   1488.8 MiB      0.3 MiB           1       print(result)


Memory = 1346.73 MB, Time = 3.12 s

------------------------------------------------

*** Run 7/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.5 MiB    142.5 MiB           1   @profile
     8                                         def filtering_counting():
     9    142.9 MiB      0.4 MiB           1       lf = pl.scan_csv(dataset_path)
    10   1664.7 MiB   1521.8 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   1664.9 MiB      0.3 MiB           1       print(result)


Memory = 1522.66 MB, Time = 2.92 s

------------------------------------------------

*** Run 8/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.6 MiB    142.6 MiB           1   @profile
     8                                         def filtering_counting():
     9    143.0 MiB      0.4 MiB           1       lf = pl.scan_csv(dataset_path)
    10   1602.6 MiB   1459.6 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   1602.9 MiB      0.2 MiB           1       print(result)


Memory = 1460.52 MB, Time = 3.06 s

------------------------------------------------

*** Run 9/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.6 MiB    142.6 MiB           1   @profile
     8                                         def filtering_counting():
     9    143.0 MiB      0.4 MiB           1       lf = pl.scan_csv(dataset_path)
    10   1648.4 MiB   1505.4 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   1648.7 MiB      0.3 MiB           1       print(result)


Memory = 1506.34 MB, Time = 3.07 s

------------------------------------------------

*** Run 10/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.5 MiB    142.5 MiB           1   @profile
     8                                         def filtering_counting():
     9    142.8 MiB      0.4 MiB           1       lf = pl.scan_csv(dataset_path)
    10   1569.9 MiB   1427.0 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   1570.1 MiB      0.2 MiB           1       print(result)


Memory = 1427.94 MB, Time = 3.13 s

--- Elapsed Time (s) ---
Mean:   3.03
Std:    0.10
CV:     3.3%
Min:    2.82
Max:    3.13
Span:   0.31

--- Memory Used (MB) ---
Mean:   1481.79
Std:    65.31
CV:     4.4%
Min:    1346.73
Max:    1596.50
Span:   249.77

[RUN] filtering_counting | hot | pandas
------------------------------------------------


*** Run 1/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    143.4 MiB    143.4 MiB           1   @profile
     8                                         def filtering_counting():
     9  11692.5 MiB  11549.2 MiB           1       df = pd.read_csv(dataset_path)
    10  12330.3 MiB    637.8 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  12330.5 MiB      0.2 MiB           1       print("Count:", len(purchases))


Memory = 11376.42 MB, Time = 60.09 s
Memory Profiler for Run 1/10

------------------------------------------------


*** Run 2/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7  11516.3 MiB  11516.3 MiB           1   @profile
     8                                         def filtering_counting():
     9   9215.9 MiB  -2300.4 MiB           1       df = pd.read_csv(dataset_path)
    10  11194.9 MiB   1979.0 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  11195.1 MiB      0.2 MiB           1       print("Count:", len(purchases))


Memory = -2401.58 MB, Time = 60.16 s
Memory Profiler for Run 2/10

------------------------------------------------


*** Run 3/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7   9117.0 MiB   9117.0 MiB           1   @profile
     8                                         def filtering_counting():
     9   9146.4 MiB     29.4 MiB           1       df = pd.read_csv(dataset_path)
    10  11119.5 MiB   1973.1 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  11119.6 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = 1245.89 MB, Time = 59.50 s
Memory Profiler for Run 3/10

------------------------------------------------


*** Run 4/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7  10364.8 MiB  10364.8 MiB           1   @profile
     8                                         def filtering_counting():
     9   9164.7 MiB  -1200.1 MiB           1       df = pd.read_csv(dataset_path)
    10  10821.1 MiB   1656.4 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  10821.3 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = -842.02 MB, Time = 59.92 s
Memory Profiler for Run 4/10

------------------------------------------------


*** Run 5/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7   9523.0 MiB   9523.0 MiB           1   @profile
     8                                         def filtering_counting():
     9   8412.4 MiB  -1110.6 MiB           1       df = pd.read_csv(dataset_path)
    10   9062.4 MiB    650.0 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11   9062.5 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = -948.83 MB, Time = 62.61 s
Memory Profiler for Run 5/10

------------------------------------------------


*** Run 6/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7   8575.2 MiB   8575.2 MiB           1   @profile
     8                                         def filtering_counting():
     9   9135.8 MiB    560.5 MiB           1       df = pd.read_csv(dataset_path)
    10  11259.4 MiB   2123.6 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  11259.5 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = 2181.91 MB, Time = 61.23 s
Memory Profiler for Run 6/10

------------------------------------------------


*** Run 7/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7  10756.3 MiB  10756.3 MiB           1   @profile
     8                                         def filtering_counting():
     9   9579.6 MiB  -1176.7 MiB           1       df = pd.read_csv(dataset_path)
    10  10675.6 MiB   1096.0 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  10675.8 MiB      0.2 MiB           1       print("Count:", len(purchases))


Memory = -597.16 MB, Time = 60.29 s
Memory Profiler for Run 7/10

------------------------------------------------


*** Run 8/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7  10159.3 MiB  10159.3 MiB           1   @profile
     8                                         def filtering_counting():
     9   9408.0 MiB   -751.3 MiB           1       df = pd.read_csv(dataset_path)
    10  11325.8 MiB   1917.9 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  11326.0 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = 667.78 MB, Time = 59.08 s
Memory Profiler for Run 8/10

------------------------------------------------


*** Run 9/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7  10825.2 MiB  10825.2 MiB           1   @profile
     8                                         def filtering_counting():
     9   9490.9 MiB  -1334.2 MiB           1       df = pd.read_csv(dataset_path)
    10  11215.7 MiB   1724.8 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  11215.9 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = -75.73 MB, Time = 59.39 s
Memory Profiler for Run 9/10

------------------------------------------------


*** Run 10/10 ***

Count: 916939
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/pandas_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7  10751.5 MiB  10751.5 MiB           1   @profile
     8                                         def filtering_counting():
     9   9047.3 MiB  -1704.2 MiB           1       df = pd.read_csv(dataset_path)
    10  12234.5 MiB   3187.2 MiB           1       purchases = df[df["event_type"] == "purchase"]
    11  12234.6 MiB      0.1 MiB           1       print("Count:", len(purchases))


Memory = 881.66 MB, Time = 61.03 s
Memory Profiler for Run 10/10

--- Elapsed Time (s) ---
Mean:   60.33
Std:    1.05
CV:     1.7%
Min:    59.08
Max:    62.61
Span:   3.53

--- Memory Used (MB) ---
Mean:   1148.83
Std:    3822.45
CV:     332.7%
Min:    -2401.58
Max:    11376.42
Span:   13778.00

[RUN] filtering_counting | hot | duckdb
------------------------------------------------


*** Run 1/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.3 MiB    142.3 MiB           1   @profile
     8                                         def filtering_counting():
     9    336.8 MiB    194.4 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 194.66 MB, Time = 2.18 s
Memory Profiler for Run 1/10

------------------------------------------------


*** Run 2/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    336.8 MiB    336.8 MiB           1   @profile
     8                                         def filtering_counting():
     9    490.0 MiB    153.2 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 153.22 MB, Time = 2.40 s
Memory Profiler for Run 2/10

------------------------------------------------


*** Run 3/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    490.0 MiB    490.0 MiB           1   @profile
     8                                         def filtering_counting():
     9    490.1 MiB      0.1 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 0.12 MB, Time = 2.22 s
Memory Profiler for Run 3/10

------------------------------------------------


*** Run 4/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    490.1 MiB    490.1 MiB           1   @profile
     8                                         def filtering_counting():
     9    612.4 MiB    122.3 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 122.27 MB, Time = 2.25 s
Memory Profiler for Run 4/10

------------------------------------------------


*** Run 5/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    612.4 MiB    612.4 MiB           1   @profile
     8                                         def filtering_counting():
     9    765.2 MiB    152.8 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 152.83 MB, Time = 2.29 s
Memory Profiler for Run 5/10

------------------------------------------------


*** Run 6/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    765.2 MiB    765.2 MiB           1   @profile
     8                                         def filtering_counting():
     9    765.2 MiB      0.0 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 0.05 MB, Time = 2.20 s
Memory Profiler for Run 6/10

------------------------------------------------


*** Run 7/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    765.2 MiB    765.2 MiB           1   @profile
     8                                         def filtering_counting():
     9    765.3 MiB      0.1 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 0.08 MB, Time = 2.17 s
Memory Profiler for Run 7/10

------------------------------------------------


*** Run 8/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    765.3 MiB    765.3 MiB           1   @profile
     8                                         def filtering_counting():
     9    765.4 MiB      0.1 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 0.09 MB, Time = 2.16 s
Memory Profiler for Run 8/10

------------------------------------------------


*** Run 9/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    765.4 MiB    765.4 MiB           1   @profile
     8                                         def filtering_counting():
     9    826.6 MiB     61.2 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 61.16 MB, Time = 2.20 s
Memory Profiler for Run 9/10

------------------------------------------------


*** Run 10/10 ***

┌────────────────┐
│ purchase_count │
│     int64      │
├────────────────┤
│         916939 │
└────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    826.6 MiB    826.6 MiB           1   @profile
     8                                         def filtering_counting():
     9    829.5 MiB      2.9 MiB           1       duckdb.sql(f"SELECT COUNT(*) AS purchase_count FROM read_csv_auto('{dataset_path}') WHERE event_type = 'purchase'").show()


Memory = 2.94 MB, Time = 2.17 s
Memory Profiler for Run 10/10

--- Elapsed Time (s) ---
Mean:   2.22
Std:    0.07
CV:     3.3%
Min:    2.16
Max:    2.40
Span:   0.24

--- Memory Used (MB) ---
Mean:   68.74
Std:    79.00
CV:     114.9%
Min:    0.05
Max:    194.66
Span:   194.61

[RUN] filtering_counting | hot | polars
------------------------------------------------


*** Run 1/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7    142.7 MiB    142.7 MiB           1   @profile
     8                                         def filtering_counting():
     9    143.1 MiB      0.4 MiB           1       lf = pl.scan_csv(dataset_path)
    10   1593.9 MiB   1450.8 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   1594.1 MiB      0.2 MiB           1       print(result)


Memory = 1451.67 MB, Time = 3.19 s
Memory Profiler for Run 1/10

------------------------------------------------


*** Run 2/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7   1594.1 MiB   1594.1 MiB           1   @profile
     8                                         def filtering_counting():
     9   1594.1 MiB      0.0 MiB           1       lf = pl.scan_csv(dataset_path)
    10   3304.2 MiB   1710.1 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   1722.7 MiB  -1581.5 MiB           1       print(result)


Memory = 128.58 MB, Time = 2.80 s
Memory Profiler for Run 2/10

------------------------------------------------


*** Run 3/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7   1722.7 MiB   1722.7 MiB           1   @profile
     8                                         def filtering_counting():
     9   1722.7 MiB      0.0 MiB           1       lf = pl.scan_csv(dataset_path)
    10   6712.9 MiB   4990.2 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   6680.9 MiB    -32.0 MiB           1       print(result)


Memory = 4926.17 MB, Time = 2.91 s
Memory Profiler for Run 3/10

------------------------------------------------


*** Run 4/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7   6584.9 MiB   6584.9 MiB           1   @profile
     8                                         def filtering_counting():
     9   6456.9 MiB   -128.0 MiB           1       lf = pl.scan_csv(dataset_path)
    10   6490.1 MiB     33.2 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   4922.1 MiB  -1568.0 MiB           1       print(result)


Memory = -1758.77 MB, Time = 3.02 s
Memory Profiler for Run 4/10

------------------------------------------------


*** Run 5/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7   4762.1 MiB   4762.1 MiB           1   @profile
     8                                         def filtering_counting():
     9   4570.1 MiB   -192.0 MiB           1       lf = pl.scan_csv(dataset_path)
    10   1884.2 MiB  -2685.9 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   1884.2 MiB      0.0 MiB           1       print(result)


Memory = -2973.86 MB, Time = 3.11 s
Memory Profiler for Run 5/10

------------------------------------------------


*** Run 6/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7   1884.2 MiB   1884.2 MiB           1   @profile
     8                                         def filtering_counting():
     9   1884.2 MiB      0.0 MiB           1       lf = pl.scan_csv(dataset_path)
    10   1987.5 MiB    103.2 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   1987.5 MiB      0.0 MiB           1       print(result)


Memory = 103.23 MB, Time = 2.70 s
Memory Profiler for Run 6/10

------------------------------------------------


*** Run 7/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7   1987.5 MiB   1987.5 MiB           1   @profile
     8                                         def filtering_counting():
     9   1987.5 MiB      0.0 MiB           1       lf = pl.scan_csv(dataset_path)
    10  10425.4 MiB   8437.9 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   6777.4 MiB  -3648.0 MiB           1       print(result)


Memory = 4757.92 MB, Time = 2.87 s
Memory Profiler for Run 7/10

------------------------------------------------


*** Run 8/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7   6713.4 MiB   6713.4 MiB           1   @profile
     8                                         def filtering_counting():
     9   6617.4 MiB    -96.0 MiB           1       lf = pl.scan_csv(dataset_path)
    10   2005.3 MiB  -4612.1 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   2005.3 MiB      0.0 MiB           1       print(result)


Memory = -4740.09 MB, Time = 2.82 s
Memory Profiler for Run 8/10

------------------------------------------------


*** Run 9/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7   2005.3 MiB   2005.3 MiB           1   @profile
     8                                         def filtering_counting():
     9   2005.3 MiB      0.0 MiB           1       lf = pl.scan_csv(dataset_path)
    10   6663.9 MiB   4658.5 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11   6599.9 MiB    -64.0 MiB           1       print(result)


Memory = 4594.55 MB, Time = 3.01 s
Memory Profiler for Run 9/10

------------------------------------------------


*** Run 10/10 ***

shape: (1, 9)
┌────────────┬────────────┬────────────┬─────────────┬───┬────────┬────────┬─────────┬─────────────┐
│ event_time ┆ event_type ┆ product_id ┆ category_id ┆ … ┆ brand  ┆ price  ┆ user_id ┆ user_sessio │
│ ---        ┆ ---        ┆ ---        ┆ ---         ┆   ┆ ---    ┆ ---    ┆ ---     ┆ n           │
│ u32        ┆ u32        ┆ u32        ┆ u32         ┆   ┆ u32    ┆ u32    ┆ u32     ┆ ---         │
│            ┆            ┆            ┆             ┆   ┆        ┆        ┆         ┆ u32         │
╞════════════╪════════════╪════════════╪═════════════╪═══╪════════╪════════╪═════════╪═════════════╡
│ 916939     ┆ 916939     ┆ 916939     ┆ 916939      ┆ … ┆ 843666 ┆ 916939 ┆ 916939  ┆ 916939      │
└────────────┴────────────┴────────────┴─────────────┴───┴────────┴────────┴─────────┴─────────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
     7   6535.9 MiB   6535.9 MiB           1   @profile
     8                                         def filtering_counting():
     9   6407.9 MiB   -128.0 MiB           1       lf = pl.scan_csv(dataset_path)
    10  10354.6 MiB   3946.7 MiB           1       result = lf.filter(pl.col("event_type") == "purchase").count().collect(streaming=True)
    11  10322.6 MiB    -32.0 MiB           1       print(result)


Memory = 3690.72 MB, Time = 3.02 s
Memory Profiler for Run 10/10

--- Elapsed Time (s) ---
Mean:   2.94
Std:    0.15
CV:     5.1%
Min:    2.70
Max:    3.19
Span:   0.49

--- Memory Used (MB) ---
Mean:   1018.01
Std:    3461.10
CV:     340.0%
Min:    -4740.09
Max:    4926.17
Span:   9666.26

=== Phase 2: Plotting figures (saving to disk, no pop-ups) ===
[PLOT] Line: filtering_counting | cold | pandas -> results/pandas_filtering_counting_cold.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/pandas_filtering_counting_cold.png
[PLOT] Line: filtering_counting | cold | duckdb -> results/duckdb_filtering_counting_cold.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/duckdb_filtering_counting_cold.png
[PLOT] Line: filtering_counting | cold | polars -> results/polars_filtering_counting_cold.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/polars_filtering_counting_cold.png
[PLOT] Line: filtering_counting | hot | pandas -> results/pandas_filtering_counting_hot.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/pandas_filtering_counting_hot.png
[PLOT] Line: filtering_counting | hot | duckdb -> results/duckdb_filtering_counting_hot.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/duckdb_filtering_counting_hot.png
[PLOT] Line: filtering_counting | hot | polars -> results/polars_filtering_counting_hot.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/polars_filtering_counting_hot.png
[PLOT] Bars: filtering_counting | cold -> results/pandas_duckdb_polars_filtering_counting_cold_bar.png
Figure saved as results/pandas_duckdb_polars_filtering_counting_cold_bar.png
[PLOT] Bars: filtering_counting | hot -> results/pandas_duckdb_polars_filtering_counting_hot_bar.png
Figure saved as results/pandas_duckdb_polars_filtering_counting_hot_bar.png
[PLOT] Hot vs Cold: filtering_counting -> results/pandas_duckdb_polars_filtering_counting_hot_cold_bar.png
Figure saved as results/pandas_duckdb_polars_filtering_counting_hot_cold_bar.png
[PLOT] Multi-line: filtering_counting | cold -> results/pandas_duckdb_polars_filtering_counting_cold.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/pandas_duckdb_polars_filtering_counting_cold.png
[PLOT] Multi-line: filtering_counting | hot -> results/pandas_duckdb_polars_filtering_counting_hot.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/pandas_duckdb_polars_filtering_counting_hot.png
