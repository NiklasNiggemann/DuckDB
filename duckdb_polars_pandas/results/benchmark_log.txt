
------------------------------------------------


*** Run 1/10 ***

shape: (130, 4)
┌─────────────────────────────────┬────────┬───────┬───────────┐
│ category_code                   ┆ views  ┆ carts ┆ purchases │
│ ---                             ┆ ---    ┆ ---   ┆ ---       │
│ str                             ┆ u32    ┆ u32   ┆ u32       │
╞═════════════════════════════════╪════════╪═══════╪═══════════╡
│ kids.carriage                   ┆ 336311 ┆ 8491  ┆ 2674      │
│ sport.trainer                   ┆ 93430  ┆ 2671  ┆ 693       │
│ apparel.shirt                   ┆ 50460  ┆ 513   ┆ 122       │
│ country_yard.cultivator         ┆ 9557   ┆ 162   ┆ 18        │
│ construction.tools.pump         ┆ 41675  ┆ 1568  ┆ 326       │
│ …                               ┆ …      ┆ …     ┆ …         │
│ appliances.kitchen.steam_cooke… ┆ 18856  ┆ 578   ┆ 207       │
│ furniture.bathroom.bath         ┆ 22472  ┆ 561   ┆ 130       │
│ sport.snowboard                 ┆ 17375  ┆ 423   ┆ 138       │
│ sport.bicycle                   ┆ 106037 ┆ 2227  ┆ 536       │
│ country_yard.furniture.bench    ┆ 2      ┆ 0     ┆ 0         │
└─────────────────────────────────┴────────┴───────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23    142.8 MiB    142.8 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  20639.0 MiB  20496.2 MiB           1       df = pl.read_csv(dataset_path)
    26   5363.9 MiB -15242.4 MiB           1       result = (
    27  20606.5 MiB    -32.5 MiB           1           df.group_by("category_code")
    28  20606.2 MiB  -6560.5 MiB           2           .agg([
    29  11924.2 MiB  -8682.1 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30  11924.2 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31  11924.2 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   5364.1 MiB      0.2 MiB           1       print(result)


Memory = 5233.06 MB, Time = 7.15 s
Memory Profiler for Run 1/10

------------------------------------------------


*** Run 2/10 ***

shape: (130, 4)
┌─────────────────────────────────┬──────────┬─────────┬───────────┐
│ category_code                   ┆ views    ┆ carts   ┆ purchases │
│ ---                             ┆ ---      ┆ ---     ┆ ---       │
│ str                             ┆ u32      ┆ u32     ┆ u32       │
╞═════════════════════════════════╪══════════╪═════════╪═══════════╡
│ apparel.jeans                   ┆ 52145    ┆ 652     ┆ 169       │
│ apparel.jumper                  ┆ 31269    ┆ 324     ┆ 82        │
│ electronics.camera.video        ┆ 63819    ┆ 1616    ┆ 393       │
│ medicine.tools.tonometer        ┆ 20764    ┆ 1274    ┆ 344       │
│ appliances.kitchen.coffee_grin… ┆ 18206    ┆ 559     ┆ 141       │
│ …                               ┆ …        ┆ …       ┆ …         │
│ appliances.ironing_board        ┆ 60187    ┆ 2744    ┆ 890       │
│ apparel.skirt                   ┆ 8766     ┆ 61      ┆ 10        │
│ electronics.smartphone          ┆ 14832387 ┆ 1159966 ┆ 382647    │
│ construction.tools.saw          ┆ 185580   ┆ 7488    ┆ 1810      │
│ construction.tools.painting     ┆ 19791    ┆ 449     ┆ 109       │
└─────────────────────────────────┴──────────┴─────────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   5375.6 MiB   5375.6 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  11706.6 MiB   6331.0 MiB           1       df = pl.read_csv(dataset_path)
    26   6066.4 MiB      0.1 MiB           1       result = (
    27   4603.6 MiB  -7103.0 MiB           1           df.group_by("category_code")
    28   6066.2 MiB   1461.6 MiB           2           .agg([
    29   4604.6 MiB      1.0 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30   4604.6 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31   4604.6 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   6067.1 MiB      0.7 MiB           1       print(result)


Memory = 703.06 MB, Time = 15.84 s
Memory Profiler for Run 2/10

------------------------------------------------


*** Run 3/10 ***

shape: (130, 4)
┌─────────────────────────────────┬─────────┬───────┬───────────┐
│ category_code                   ┆ views   ┆ carts ┆ purchases │
│ ---                             ┆ ---     ┆ ---   ┆ ---       │
│ str                             ┆ u32     ┆ u32   ┆ u32       │
╞═════════════════════════════════╪═════════╪═══════╪═══════════╡
│ electronics.audio.subwoofer     ┆ 305995  ┆ 10013 ┆ 3130      │
│ furniture.universal.light       ┆ 15856   ┆ 185   ┆ 47        │
│ appliances.kitchen.coffee_grin… ┆ 18206   ┆ 559   ┆ 141       │
│ appliances.kitchen.kettle       ┆ 264161  ┆ 12196 ┆ 3559      │
│ apparel.glove                   ┆ 3737    ┆ 70    ┆ 17        │
│ …                               ┆ …       ┆ …     ┆ …         │
│ computers.peripherals.monitor   ┆ 203806  ┆ 5923  ┆ 1613      │
│ appliances.environment.water_h… ┆ 194075  ┆ 11914 ┆ 3382      │
│ electronics.video.projector     ┆ 22423   ┆ 418   ┆ 99        │
│ apparel.shoes.ballet_shoes      ┆ 4299    ┆ 58    ┆ 22        │
│ appliances.environment.vacuum   ┆ 1445029 ┆ 64836 ┆ 18193     │
└─────────────────────────────────┴─────────┴───────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   6080.9 MiB   6080.9 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25   6566.9 MiB    486.0 MiB           1       df = pl.read_csv(dataset_path)
    26   8062.2 MiB      0.0 MiB           1       result = (
    27   6567.4 MiB      0.5 MiB           1           df.group_by("category_code")
    28   8062.2 MiB   1493.8 MiB           2           .agg([
    29   6568.8 MiB      1.5 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30   6568.8 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31   6568.5 MiB     -0.4 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   8062.5 MiB      0.2 MiB           1       print(result)


Memory = 1996.17 MB, Time = 16.55 s
Memory Profiler for Run 3/10

------------------------------------------------


*** Run 4/10 ***

shape: (130, 4)
┌───────────────────────────────┬──────────┬────────┬───────────┐
│ category_code                 ┆ views    ┆ carts  ┆ purchases │
│ ---                           ┆ ---      ┆ ---    ┆ ---       │
│ str                           ┆ u32      ┆ u32    ┆ u32       │
╞═══════════════════════════════╪══════════╪════════╪═══════════╡
│ apparel.shoes                 ┆ 1836676  ┆ 40074  ┆ 10140     │
│ computers.components.cpu      ┆ 81644    ┆ 2139   ┆ 510       │
│ furniture.kitchen.chair       ┆ 180695   ┆ 6286   ┆ 1740      │
│ construction.tools.painting   ┆ 19791    ┆ 449    ┆ 109       │
│ appliances.environment.fan    ┆ 3316     ┆ 81     ┆ 32        │
│ …                             ┆ …        ┆ …      ┆ …         │
│ appliances.kitchen.washer     ┆ 1313807  ┆ 70287  ┆ 19772     │
│ null                          ┆ 20837460 ┆ 826493 ┆ 234218    │
│ appliances.environment.vacuum ┆ 1445029  ┆ 64836  ┆ 18193     │
│ auto.accessories.player       ┆ 456658   ┆ 12647  ┆ 3793      │
│ apparel.shoes.espadrilles     ┆ 1404     ┆ 8      ┆ 0         │
└───────────────────────────────┴──────────┴────────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   8076.9 MiB   8076.9 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  17295.5 MiB   9218.5 MiB           1       df = pl.read_csv(dataset_path)
    26   5801.1 MiB  -9909.4 MiB           1       result = (
    27  15742.7 MiB  -1552.8 MiB           1           df.group_by("category_code")
    28  15710.5 MiB  -2997.3 MiB           2           .agg([
    29   8766.1 MiB  -6944.4 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30   8766.1 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31   8766.1 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   5801.7 MiB      0.6 MiB           1       print(result)


Memory = -2256.56 MB, Time = 15.16 s
Memory Profiler for Run 4/10

------------------------------------------------


*** Run 5/10 ***

shape: (130, 4)
┌────────────────────────────────┬────────┬───────┬───────────┐
│ category_code                  ┆ views  ┆ carts ┆ purchases │
│ ---                            ┆ ---    ┆ ---   ┆ ---       │
│ str                            ┆ u32    ┆ u32   ┆ u32       │
╞════════════════════════════════╪════════╪═══════╪═══════════╡
│ furniture.bedroom.blanket      ┆ 28269  ┆ 657   ┆ 214       │
│ apparel.costume                ┆ 241589 ┆ 2823  ┆ 879       │
│ electronics.tablet             ┆ 464073 ┆ 22286 ┆ 6138      │
│ construction.components.faucet ┆ 45919  ┆ 1322  ┆ 388       │
│ auto.accessories.parktronic    ┆ 14337  ┆ 271   ┆ 73        │
│ …                              ┆ …      ┆ …     ┆ …         │
│ apparel.jeans                  ┆ 52145  ┆ 652   ┆ 169       │
│ apparel.shorts                 ┆ 639    ┆ 11    ┆ 2         │
│ sport.tennis                   ┆ 7539   ┆ 154   ┆ 48        │
│ computers.peripherals.monitor  ┆ 203806 ┆ 5923  ┆ 1613      │
│ furniture.living_room.chair    ┆ 85811  ┆ 1946  ┆ 571       │
└────────────────────────────────┴────────┴───────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   5820.7 MiB   5820.7 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  19453.4 MiB  13632.7 MiB           1       df = pl.read_csv(dataset_path)
    26   5852.8 MiB  -5265.9 MiB           1       result = (
    27  11118.6 MiB  -8334.8 MiB           1           df.group_by("category_code")
    28  11118.6 MiB  -5267.0 MiB           2           .agg([
    29  11119.7 MiB      1.0 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30  11119.7 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31  11119.7 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   5853.4 MiB      0.6 MiB           1       print(result)


Memory = 48.92 MB, Time = 13.83 s
Memory Profiler for Run 5/10

------------------------------------------------


*** Run 6/10 ***

shape: (130, 4)
┌─────────────────────────────────┬──────────┬────────┬───────────┐
│ category_code                   ┆ views    ┆ carts  ┆ purchases │
│ ---                             ┆ ---      ┆ ---    ┆ ---       │
│ str                             ┆ u32      ┆ u32    ┆ u32       │
╞═════════════════════════════════╪══════════╪════════╪═══════════╡
│ electronics.telephone           ┆ 327630   ┆ 14832  ┆ 4338      │
│ auto.accessories.parktronic     ┆ 14337    ┆ 271    ┆ 73        │
│ appliances.personal.hair_cutte… ┆ 85361    ┆ 3592   ┆ 1162      │
│ null                            ┆ 20837460 ┆ 826493 ┆ 234218    │
│ electronics.audio.music_tools.… ┆ 60363    ┆ 2280   ┆ 696       │
│ …                               ┆ …        ┆ …      ┆ …         │
│ appliances.personal.massager    ┆ 42291    ┆ 1468   ┆ 522       │
│ appliances.kitchen.mixer        ┆ 140422   ┆ 5719   ┆ 1724      │
│ appliances.sewing_machine       ┆ 266114   ┆ 11580  ┆ 2909      │
│ sport.tennis                    ┆ 7539     ┆ 154    ┆ 48        │
│ auto.accessories.player         ┆ 456658   ┆ 12647  ┆ 3793      │
└─────────────────────────────────┴──────────┴────────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   5869.8 MiB   5869.8 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  11413.1 MiB   5543.4 MiB           1       df = pl.read_csv(dataset_path)
    26   6514.6 MiB  -3093.4 MiB           1       result = (
    27   9608.0 MiB  -1805.2 MiB           1           df.group_by("category_code")
    28   9608.0 MiB  -3094.5 MiB           2           .agg([
    29   9609.0 MiB      1.0 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30   9609.0 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31   9609.0 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   6515.5 MiB      0.9 MiB           1       print(result)


Memory = 664.45 MB, Time = 14.33 s
Memory Profiler for Run 6/10

------------------------------------------------


*** Run 7/10 ***

shape: (130, 4)
┌───────────────────────────────┬────────┬───────┬───────────┐
│ category_code                 ┆ views  ┆ carts ┆ purchases │
│ ---                           ┆ ---    ┆ ---   ┆ ---       │
│ str                           ┆ u32    ┆ u32   ┆ u32       │
╞═══════════════════════════════╪════════╪═══════╪═══════════╡
│ construction.tools.painting   ┆ 19791  ┆ 449   ┆ 109       │
│ construction.tools.pump       ┆ 41675  ┆ 1568  ┆ 326       │
│ appliances.personal.massager  ┆ 42291  ┆ 1468  ┆ 522       │
│ computers.components.cpu      ┆ 81644  ┆ 2139  ┆ 510       │
│ computers.peripherals.camera  ┆ 7061   ┆ 194   ┆ 36        │
│ …                             ┆ …      ┆ …     ┆ …         │
│ electronics.telephone         ┆ 327630 ┆ 14832 ┆ 4338      │
│ stationery.cartrige           ┆ 11943  ┆ 644   ┆ 191       │
│ appliances.kitchen.dishwasher ┆ 156018 ┆ 3896  ┆ 1018      │
│ auto.accessories.winch        ┆ 5876   ┆ 56    ┆ 20        │
│ kids.dolls                    ┆ 86219  ┆ 1710  ┆ 437       │
└───────────────────────────────┴────────┴───────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   6534.5 MiB   6534.5 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  18099.4 MiB  11564.9 MiB           1       df = pl.read_csv(dataset_path)
    26   6357.3 MiB  -4144.9 MiB           1       result = (
    27  10502.2 MiB  -7597.3 MiB           1           df.group_by("category_code")
    28  10502.2 MiB  -4146.1 MiB           2           .agg([
    29  10503.2 MiB      1.0 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30  10503.2 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31  10503.2 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   6358.0 MiB      0.7 MiB           1       print(result)


Memory = -158.11 MB, Time = 14.60 s
Memory Profiler for Run 7/10

------------------------------------------------


*** Run 8/10 ***

shape: (130, 4)
┌─────────────────────────────────┬──────────┬────────┬───────────┐
│ category_code                   ┆ views    ┆ carts  ┆ purchases │
│ ---                             ┆ ---      ┆ ---    ┆ ---       │
│ str                             ┆ u32      ┆ u32    ┆ u32       │
╞═════════════════════════════════╪══════════╪════════╪═══════════╡
│ appliances.kitchen.microwave    ┆ 285186   ┆ 15938  ┆ 5146      │
│ computers.peripherals.printer   ┆ 209130   ┆ 9900   ┆ 2698      │
│ computers.notebook              ┆ 2103024  ┆ 59097  ┆ 18433     │
│ construction.tools.welding      ┆ 141960   ┆ 5431   ┆ 1119      │
│ auto.accessories.compressor     ┆ 85659    ┆ 2682   ┆ 700       │
│ …                               ┆ …        ┆ …      ┆ …         │
│ appliances.kitchen.juicer       ┆ 71894    ┆ 2501   ┆ 733       │
│ construction.tools.light        ┆ 30203    ┆ 493    ┆ 88        │
│ computers.components.power_sup… ┆ 33989    ┆ 1179   ┆ 346       │
│ furniture.bathroom.toilet       ┆ 28060    ┆ 964    ┆ 213       │
│ null                            ┆ 20837460 ┆ 826493 ┆ 234218    │
└─────────────────────────────────┴──────────┴────────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   6376.4 MiB   6376.4 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  11445.0 MiB   5068.6 MiB           1       df = pl.read_csv(dataset_path)
    26   6378.9 MiB  -4315.9 MiB           1       result = (
    27  10694.8 MiB   -750.2 MiB           1           df.group_by("category_code")
    28  10694.8 MiB  -4317.1 MiB           2           .agg([
    29  10695.8 MiB      1.0 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30  10695.8 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31  10695.8 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   6379.5 MiB      0.6 MiB           1       print(result)


Memory = 20.75 MB, Time = 13.93 s
Memory Profiler for Run 8/10

------------------------------------------------


*** Run 9/10 ***

shape: (130, 4)
┌───────────────────────────────┬────────┬───────┬───────────┐
│ category_code                 ┆ views  ┆ carts ┆ purchases │
│ ---                           ┆ ---    ┆ ---   ┆ ---       │
│ str                           ┆ u32    ┆ u32   ┆ u32       │
╞═══════════════════════════════╪════════╪═══════╪═══════════╡
│ appliances.kitchen.hood       ┆ 191699 ┆ 5874  ┆ 1484      │
│ auto.accessories.winch        ┆ 5876   ┆ 56    ┆ 20        │
│ apparel.glove                 ┆ 3737   ┆ 70    ┆ 17        │
│ apparel.trousers              ┆ 25019  ┆ 240   ┆ 50        │
│ computers.peripherals.printer ┆ 209130 ┆ 9900  ┆ 2698      │
│ …                             ┆ …      ┆ …     ┆ …         │
│ sport.trainer                 ┆ 93430  ┆ 2671  ┆ 693       │
│ kids.fmcg.diapers             ┆ 29296  ┆ 2463  ┆ 819       │
│ computers.peripherals.mouse   ┆ 109467 ┆ 5002  ┆ 1321      │
│ computers.components.cpu      ┆ 81644  ┆ 2139  ┆ 510       │
│ furniture.universal.light     ┆ 15856  ┆ 185   ┆ 47        │
└───────────────────────────────┴────────┴───────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   6397.3 MiB   6397.3 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  10782.3 MiB   4385.0 MiB           1       df = pl.read_csv(dataset_path)
    26   5505.5 MiB  -2927.7 MiB           1       result = (
    27   8433.2 MiB  -2349.0 MiB           1           df.group_by("category_code")
    28   8433.2 MiB  -2928.9 MiB           2           .agg([
    29   8434.3 MiB      1.0 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30   8434.3 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31   8434.3 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   5506.4 MiB      0.9 MiB           1       print(result)


Memory = -872.39 MB, Time = 15.81 s
Memory Profiler for Run 9/10

------------------------------------------------


*** Run 10/10 ***

shape: (130, 4)
┌────────────────────────────┬─────────┬───────┬───────────┐
│ category_code              ┆ views   ┆ carts ┆ purchases │
│ ---                        ┆ ---     ┆ ---   ┆ ---       │
│ str                        ┆ u32     ┆ u32   ┆ u32       │
╞════════════════════════════╪═════════╪═══════╪═══════════╡
│ electronics.audio.acoustic ┆ 137239  ┆ 3630  ┆ 1153      │
│ apparel.jumper             ┆ 31269   ┆ 324   ┆ 82        │
│ furniture.kitchen.chair    ┆ 180695  ┆ 6286  ┆ 1740      │
│ appliances.kitchen.oven    ┆ 362455  ┆ 13149 ┆ 3734      │
│ furniture.living_room.sofa ┆ 417428  ┆ 6521  ┆ 1562      │
│ …                          ┆ …       ┆ …     ┆ …         │
│ computers.notebook         ┆ 2103024 ┆ 59097 ┆ 18433     │
│ apparel.shoes.ballet_shoes ┆ 4299    ┆ 58    ┆ 22        │
│ apparel.shoes.sandals      ┆ 15139   ┆ 155   ┆ 49        │
│ electronics.camera.video   ┆ 63819   ┆ 1616  ┆ 393       │
│ apparel.shoes              ┆ 1836676 ┆ 40074 ┆ 10140     │
└────────────────────────────┴─────────┴───────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   5525.0 MiB   5525.0 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  18923.0 MiB  13398.0 MiB           1       df = pl.read_csv(dataset_path)
    26   5857.5 MiB -12438.7 MiB           1       result = (
    27  18296.4 MiB   -626.6 MiB           1           df.group_by("category_code")
    28  18296.2 MiB  -4718.0 MiB           2           .agg([
    29  10575.1 MiB  -7721.1 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30  10575.1 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31  10575.1 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   5858.4 MiB      0.9 MiB           1       print(result)


Memory = 350.84 MB, Time = 13.80 s
Memory Profiler for Run 10/10
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ------------------------------------------------


*** Run 1/10 ***

┌───────────────────────────────────┬────────┬────────┬───────────┐
│           category_code           │ views  │ carts  │ purchases │
│              varchar              │ int128 │ int128 │  int128   │
├───────────────────────────────────┼────────┼────────┼───────────┤
│ apparel.tshirt                    │  21179 │    284 │        93 │
│ furniture.kitchen.table           │ 192562 │   4246 │      1284 │
│ kids.carriage                     │ 336311 │   8491 │      2674 │
│ electronics.telephone             │ 327630 │  14832 │      4338 │
│ computers.components.power_supply │  33989 │   1179 │       346 │
│ construction.components.faucet    │  45919 │   1322 │       388 │
│ furniture.universal.light         │  15856 │    185 │        47 │
│ apparel.shoes.slipons             │   5552 │     52 │         9 │
│ computers.peripherals.camera      │   7061 │    194 │        36 │
│ apparel.shorts                    │    639 │     11 │         2 │
│       ·                           │     ·  │      · │         · │
│       ·                           │     ·  │      · │         · │
│       ·                           │     ·  │      · │         · │
│ appliances.kitchen.mixer          │ 140422 │   5719 │      1724 │
│ furniture.bedroom.blanket         │  28269 │    657 │       214 │
│ country_yard.lawn_mower           │   6173 │    180 │        38 │
│ construction.tools.drill          │ 381287 │  13375 │      3198 │
│ furniture.bathroom.bath           │  22472 │    561 │       130 │
│ sport.bicycle                     │ 106037 │   2227 │       536 │
│ computers.peripherals.monitor     │ 203806 │   5923 │      1613 │
│ furniture.bathroom.toilet         │  28060 │    964 │       213 │
│ apparel.shoes.sandals             │  15139 │    155 │        49 │
│ construction.tools.screw          │    182 │      1 │         1 │
├───────────────────────────────────┴────────┴────────┴───────────┤
│ 130 rows (20 shown)                                   4 columns │
└─────────────────────────────────────────────────────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    22    143.3 MiB    143.3 MiB           1   @profile
    23                                         def grouping_conditional_aggregation():
    24    179.7 MiB     36.4 MiB           2       duckdb.sql(
    25    143.3 MiB      0.0 MiB           2           f"""
    26                                                 SELECT
    27                                                     category_code,
    28                                                     SUM(CASE WHEN event_type = 'view' THEN 1 ELSE 0 END) AS views,
    29                                                     SUM(CASE WHEN event_type = 'cart' THEN 1 ELSE 0 END) AS carts,
    30                                                     SUM(CASE WHEN event_type = 'purchase' THEN 1 ELSE 0 END) AS purchases
    31    143.3 MiB      0.0 MiB           1           FROM read_csv_auto('{dataset_path}')
    32                                                 GROUP BY category_code
    33                                                 """
    34    355.4 MiB    175.7 MiB           1       ).show()


Memory = 212.28 MB, Time = 2.45 s
Memory Profiler for Run 1/10

------------------------------------------------


*** Run 2/10 ***

┌─────────────────────────────────┬────────┬────────┬───────────┐
│          category_code          │ views  │ carts  │ purchases │
│             varchar             │ int128 │ int128 │  int128   │
├─────────────────────────────────┼────────┼────────┼───────────┤
│ computers.components.memory     │  76162 │   3057 │       876 │
│ appliances.kitchen.hood         │ 191699 │   5874 │      1484 │
│ furniture.living_room.sofa      │ 417428 │   6521 │      1562 │
│ appliances.kitchen.meat_grinder │ 242604 │  10737 │      3010 │
│ medicine.tools.tonometer        │  20764 │   1274 │       344 │
│ auto.accessories.anti_freeze    │   3397 │     96 │        18 │
│ apparel.shirt                   │  50460 │    513 │       122 │
│ electronics.video.projector     │  22423 │    418 │        99 │
│ sport.snowboard                 │  17375 │    423 │       138 │
│ auto.accessories.winch          │   5876 │     56 │        20 │
│           ·                     │     ·  │      · │         · │
│           ·                     │     ·  │      · │         · │
│           ·                     │     ·  │      · │         · │
│ computers.peripherals.printer   │ 209130 │   9900 │      2698 │
│ electronics.audio.acoustic      │ 137239 │   3630 │      1153 │
│ computers.peripherals.mouse     │ 109467 │   5002 │      1321 │
│ furniture.bedroom.blanket       │  28269 │    657 │       214 │
│ apparel.costume                 │ 241589 │   2823 │       879 │
│ auto.accessories.compressor     │  85659 │   2682 │       700 │
│ kids.swing                      │  57430 │   1556 │       482 │
│ apparel.scarf                   │   3567 │     43 │         8 │
│ sport.tennis                    │   7539 │    154 │        48 │
│ appliances.kitchen.fryer        │     99 │      8 │         1 │
├─────────────────────────────────┴────────┴────────┴───────────┤
│ 130 rows (20 shown)                                 4 columns │
└───────────────────────────────────────────────────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    22    355.4 MiB    355.4 MiB           1   @profile
    23                                         def grouping_conditional_aggregation():
    24    355.5 MiB      0.1 MiB           2       duckdb.sql(
    25    355.4 MiB      0.0 MiB           2           f"""
    26                                                 SELECT
    27                                                     category_code,
    28                                                     SUM(CASE WHEN event_type = 'view' THEN 1 ELSE 0 END) AS views,
    29                                                     SUM(CASE WHEN event_type = 'cart' THEN 1 ELSE 0 END) AS carts,
    30                                                     SUM(CASE WHEN event_type = 'purchase' THEN 1 ELSE 0 END) AS purchases
    31    355.4 MiB      0.0 MiB           1           FROM read_csv_auto('{dataset_path}')
    32                                                 GROUP BY category_code
    33                                                 """
    34    361.8 MiB      6.3 MiB           1       ).show()


Memory = 6.42 MB, Time = 2.35 s
Memory Profiler for Run 2/10

------------------------------------------------


*** Run 3/10 ***

┌─────────────────────────────────┬─────────┬────────┬───────────┐
│          category_code          │  views  │ carts  │ purchases │
│             varchar             │ int128  │ int128 │  int128   │
├─────────────────────────────────┼─────────┼────────┼───────────┤
│ electronics.clocks              │ 1994440 │  69289 │     23237 │
│ computers.notebook              │ 2103024 │  59097 │     18433 │
│ appliances.sewing_machine       │  266114 │  11580 │      2909 │
│ furniture.living_room.chair     │   85811 │   1946 │       571 │
│ appliances.kitchen.kettle       │  264161 │  12196 │      3559 │
│ appliances.kitchen.hob          │  179125 │   5694 │      1393 │
│ computers.components.cooler     │   70234 │   2304 │       640 │
│ appliances.personal.hair_cutter │   85361 │   3592 │      1162 │
│ accessories.wallet              │   68909 │   1119 │       366 │
│ apparel.trousers                │   25019 │    240 │        50 │
│        ·                        │      ·  │      · │         · │
│        ·                        │      ·  │      · │         · │
│        ·                        │      ·  │      · │         · │
│ appliances.environment.fan      │    3316 │     81 │        32 │
│ apparel.shoes.step_ins          │    1750 │     19 │         7 │
│ apparel.glove                   │    3737 │     70 │        17 │
│ apparel.jacket                  │       1 │      0 │         0 │
│ apparel.costume                 │  241589 │   2823 │       879 │
│ kids.swing                      │   57430 │   1556 │       482 │
│ auto.accessories.compressor     │   85659 │   2682 │       700 │
│ sport.tennis                    │    7539 │    154 │        48 │
│ apparel.scarf                   │    3567 │     43 │         8 │
│ appliances.kitchen.fryer        │      99 │      8 │         1 │
├─────────────────────────────────┴─────────┴────────┴───────────┤
│ 130 rows (20 shown)                                  4 columns │
└────────────────────────────────────────────────────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    22    361.8 MiB    361.8 MiB           1   @profile
    23                                         def grouping_conditional_aggregation():
    24    361.8 MiB      0.0 MiB           2       duckdb.sql(
    25    361.8 MiB      0.0 MiB           2           f"""
    26                                                 SELECT
    27                                                     category_code,
    28                                                     SUM(CASE WHEN event_type = 'view' THEN 1 ELSE 0 END) AS views,
    29                                                     SUM(CASE WHEN event_type = 'cart' THEN 1 ELSE 0 END) AS carts,
    30                                                     SUM(CASE WHEN event_type = 'purchase' THEN 1 ELSE 0 END) AS purchases
    31    361.8 MiB      0.0 MiB           1           FROM read_csv_auto('{dataset_path}')
    32                                                 GROUP BY category_code
    33                                                 """
    34    364.5 MiB      2.7 MiB           1       ).show()


Memory = 2.72 MB, Time = 2.36 s
Memory Profiler for Run 3/10

------------------------------------------------


*** Run 4/10 ***

┌────────────────────────────────────────┬──────────┬────────┬───────────┐
│             category_code              │  views   │ carts  │ purchases │
│                varchar                 │  int128  │ int128 │  int128   │
├────────────────────────────────────────┼──────────┼────────┼───────────┤
│ NULL                                   │ 20837460 │ 826493 │    234218 │
│ appliances.environment.vacuum          │  1445029 │  64836 │     18193 │
│ computers.desktop                      │   673875 │  12846 │      3781 │
│ apparel.shoes                          │  1836676 │  40074 │     10140 │
│ kids.skates                            │    70649 │   1489 │       384 │
│ kids.toys                              │   199612 │   4992 │      1370 │
│ computers.components.memory            │    76162 │   3057 │       876 │
│ appliances.kitchen.hood                │   191699 │   5874 │      1484 │
│ furniture.living_room.sofa             │   417428 │   6521 │      1562 │
│ appliances.kitchen.meat_grinder        │   242604 │  10737 │      3010 │
│            ·                           │      ·   │     ·  │        ·  │
│            ·                           │      ·   │     ·  │        ·  │
│            ·                           │      ·   │     ·  │        ·  │
│ furniture.bedroom.pillow               │    28175 │    870 │       189 │
│ computers.components.hdd               │   108021 │   5374 │      1512 │
│ country_yard.furniture.hammok          │     1567 │     18 │         4 │
│ country_yard.cultivator                │     9557 │    162 │        18 │
│ furniture.bedroom.bed                  │   519487 │  10229 │      2957 │
│ appliances.kitchen.coffee_grinder      │    18206 │    559 │       141 │
│ kids.dolls                             │    86219 │   1710 │       437 │
│ appliances.environment.air_conditioner │    97701 │   3046 │       785 │
│ appliances.ironing_board               │    60187 │   2744 │       890 │
│ apparel.sock                           │     3455 │    101 │        19 │
├────────────────────────────────────────┴──────────┴────────┴───────────┤
│ 130 rows (20 shown)                                          4 columns │
└────────────────────────────────────────────────────────────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    22    364.5 MiB    364.5 MiB           1   @profile
    23                                         def grouping_conditional_aggregation():
    24    366.4 MiB      1.9 MiB           2       duckdb.sql(
    25    364.5 MiB      0.0 MiB           2           f"""
    26                                                 SELECT
    27                                                     category_code,
    28                                                     SUM(CASE WHEN event_type = 'view' THEN 1 ELSE 0 END) AS views,
    29                                                     SUM(CASE WHEN event_type = 'cart' THEN 1 ELSE 0 END) AS carts,
    30                                                     SUM(CASE WHEN event_type = 'purchase' THEN 1 ELSE 0 END) AS purchases
    31    364.5 MiB      0.0 MiB           1           FROM read_csv_auto('{dataset_path}')
    32                                                 GROUP BY category_code
    33                                                 """
    34    369.0 MiB      2.6 MiB           1       ).show()


Memory = 4.45 MB, Time = 2.37 s
Memory Profiler for Run 4/10

------------------------------------------------


*** Run 5/10 ***

┌───────────────────────────────────┬─────────┬────────┬───────────┐
│           category_code           │  views  │ carts  │ purchases │
│              varchar              │ int128  │ int128 │  int128   │
├───────────────────────────────────┼─────────┼────────┼───────────┤
│ auto.accessories.player           │  456658 │  12647 │      3793 │
│ electronics.audio.subwoofer       │  305995 │  10013 │      3130 │
│ electronics.video.tv              │ 2071305 │ 106467 │     30274 │
│ electronics.camera.video          │   63819 │   1616 │       393 │
│ electronics.tablet                │  464073 │  22286 │      6138 │
│ electronics.audio.microphone      │   44645 │   1615 │       489 │
│ apparel.underwear                 │   47145 │    483 │        84 │
│ appliances.environment.air_heater │  269283 │  13121 │      3583 │
│ apparel.jeans                     │   52145 │    652 │       169 │
│ computers.peripherals.keyboard    │   84909 │   2709 │       707 │
│       ·                           │     ·   │     ·  │        ·  │
│       ·                           │     ·   │     ·  │        ·  │
│       ·                           │     ·   │     ·  │        ·  │
│ apparel.shoes                     │ 1836676 │  40074 │     10140 │
│ kids.toys                         │  199612 │   4992 │      1370 │
│ kids.skates                       │   70649 │   1489 │       384 │
│ computers.peripherals.monitor     │  203806 │   5923 │      1613 │
│ construction.tools.drill          │  381287 │  13375 │      3198 │
│ sport.bicycle                     │  106037 │   2227 │       536 │
│ furniture.bathroom.bath           │   22472 │    561 │       130 │
│ furniture.bathroom.toilet         │   28060 │    964 │       213 │
│ apparel.shoes.sandals             │   15139 │    155 │        49 │
│ construction.tools.screw          │     182 │      1 │         1 │
├───────────────────────────────────┴─────────┴────────┴───────────┤
│ 130 rows (20 shown)                                    4 columns │
└──────────────────────────────────────────────────────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    22    369.0 MiB    369.0 MiB           1   @profile
    23                                         def grouping_conditional_aggregation():
    24    369.1 MiB      0.1 MiB           2       duckdb.sql(
    25    369.0 MiB      0.0 MiB           2           f"""
    26                                                 SELECT
    27                                                     category_code,
    28                                                     SUM(CASE WHEN event_type = 'view' THEN 1 ELSE 0 END) AS views,
    29                                                     SUM(CASE WHEN event_type = 'cart' THEN 1 ELSE 0 END) AS carts,
    30                                                     SUM(CASE WHEN event_type = 'purchase' THEN 1 ELSE 0 END) AS purchases
    31    369.0 MiB      0.0 MiB           1           FROM read_csv_auto('{dataset_path}')
    32                                                 GROUP BY category_code
    33                                                 """
    34    371.2 MiB      2.1 MiB           1       ).show()


Memory = 2.19 MB, Time = 2.41 s
Memory Profiler for Run 5/10

------------------------------------------------


*** Run 6/10 ***

┌────────────────────────────────────────┬────────┬────────┬───────────┐
│             category_code              │ views  │ carts  │ purchases │
│                varchar                 │ int128 │ int128 │  int128   │
├────────────────────────────────────────┼────────┼────────┼───────────┤
│ appliances.kitchen.juicer              │  71894 │   2501 │       733 │
│ electronics.audio.music_tools.piano    │  60363 │   2280 │       696 │
│ appliances.iron                        │ 278574 │  14308 │      4650 │
│ appliances.kitchen.dishwasher          │ 156018 │   3896 │      1018 │
│ auto.accessories.radar                 │  47145 │   2213 │       544 │
│ apparel.shoes.step_ins                 │   1750 │     19 │         7 │
│ appliances.environment.fan             │   3316 │     81 │        32 │
│ apparel.glove                          │   3737 │     70 │        17 │
│ apparel.jacket                         │      1 │      0 │         0 │
│ auto.accessories.compressor            │  85659 │   2682 │       700 │
│              ·                         │    ·   │     ·  │        ·  │
│              ·                         │    ·   │     ·  │        ·  │
│              ·                         │    ·   │     ·  │        ·  │
│ appliances.kitchen.steam_cooker        │  18856 │    578 │       207 │
│ construction.tools.painting            │  19791 │    449 │       109 │
│ apparel.skirt                          │   8766 │     61 │        10 │
│ country_yard.furniture.bench           │      2 │      0 │         0 │
│ furniture.bedroom.bed                  │ 519487 │  10229 │      2957 │
│ appliances.kitchen.coffee_grinder      │  18206 │    559 │       141 │
│ kids.dolls                             │  86219 │   1710 │       437 │
│ appliances.environment.air_conditioner │  97701 │   3046 │       785 │
│ apparel.sock                           │   3455 │    101 │        19 │
│ appliances.ironing_board               │  60187 │   2744 │       890 │
├────────────────────────────────────────┴────────┴────────┴───────────┤
│ 130 rows (20 shown)                                        4 columns │
└──────────────────────────────────────────────────────────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    22    371.2 MiB    371.2 MiB           1   @profile
    23                                         def grouping_conditional_aggregation():
    24    371.2 MiB      0.1 MiB           2       duckdb.sql(
    25    371.2 MiB      0.0 MiB           2           f"""
    26                                                 SELECT
    27                                                     category_code,
    28                                                     SUM(CASE WHEN event_type = 'view' THEN 1 ELSE 0 END) AS views,
    29                                                     SUM(CASE WHEN event_type = 'cart' THEN 1 ELSE 0 END) AS carts,
    30                                                     SUM(CASE WHEN event_type = 'purchase' THEN 1 ELSE 0 END) AS purchases
    31    371.2 MiB      0.0 MiB           1           FROM read_csv_auto('{dataset_path}')
    32                                                 GROUP BY category_code
    33                                                 """
    34    373.1 MiB      1.8 MiB           1       ).show()


Memory = 1.91 MB, Time = 2.40 s
Memory Profiler for Run 6/10

------------------------------------------------


*** Run 7/10 ***

┌───────────────────────────────────┬──────────┬─────────┬───────────┐
│           category_code           │  views   │  carts  │ purchases │
│              varchar              │  int128  │ int128  │  int128   │
├───────────────────────────────────┼──────────┼─────────┼───────────┤
│ apparel.costume                   │   241589 │    2823 │       879 │
│ auto.accessories.compressor       │    85659 │    2682 │       700 │
│ kids.swing                        │    57430 │    1556 │       482 │
│ apparel.scarf                     │     3567 │      43 │         8 │
│ sport.tennis                      │     7539 │     154 │        48 │
│ appliances.kitchen.fryer          │       99 │       8 │         1 │
│ kids.carriage                     │   336311 │    8491 │      2674 │
│ electronics.telephone             │   327630 │   14832 │      4338 │
│ furniture.kitchen.table           │   192562 │    4246 │      1284 │
│ apparel.tshirt                    │    21179 │     284 │        93 │
│       ·                           │      ·   │      ·  │         · │
│       ·                           │      ·   │      ·  │         · │
│       ·                           │      ·   │      ·  │         · │
│ appliances.kitchen.steam_cooker   │    18856 │     578 │       207 │
│ construction.tools.painting       │    19791 │     449 │       109 │
│ apparel.skirt                     │     8766 │      61 │        10 │
│ country_yard.furniture.bench      │        2 │       0 │         0 │
│ electronics.smartphone            │ 14832387 │ 1159966 │    382647 │
│ appliances.kitchen.washer         │  1313807 │   70287 │     19772 │
│ appliances.kitchen.coffee_machine │   128164 │    2669 │       724 │
│ computers.components.videocards   │   147797 │    4588 │      1129 │
│ apparel.dress                     │    95954 │     486 │       112 │
│ accessories.umbrella              │     4890 │      73 │        26 │
├───────────────────────────────────┴──────────┴─────────┴───────────┤
│ 130 rows (20 shown)                                      4 columns │
└────────────────────────────────────────────────────────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    22    373.1 MiB    373.1 MiB           1   @profile
    23                                         def grouping_conditional_aggregation():
    24    373.1 MiB      0.0 MiB           2       duckdb.sql(
    25    373.1 MiB      0.0 MiB           2           f"""
    26                                                 SELECT
    27                                                     category_code,
    28                                                     SUM(CASE WHEN event_type = 'view' THEN 1 ELSE 0 END) AS views,
    29                                                     SUM(CASE WHEN event_type = 'cart' THEN 1 ELSE 0 END) AS carts,
    30                                                     SUM(CASE WHEN event_type = 'purchase' THEN 1 ELSE 0 END) AS purchases
    31    373.1 MiB      0.0 MiB           1           FROM read_csv_auto('{dataset_path}')
    32                                                 GROUP BY category_code
    33                                                 """
    34    374.9 MiB      1.9 MiB           1       ).show()


Memory = 1.88 MB, Time = 2.42 s
Memory Profiler for Run 7/10

------------------------------------------------


*** Run 8/10 ***

┌─────────────────────────────────────┬─────────┬────────┬───────────┐
│            category_code            │  views  │ carts  │ purchases │
│               varchar               │ int128  │ int128 │  int128   │
├─────────────────────────────────────┼─────────┼────────┼───────────┤
│ appliances.kitchen.dishwasher       │  156018 │   3896 │      1018 │
│ appliances.iron                     │  278574 │  14308 │      4650 │
│ appliances.kitchen.juicer           │   71894 │   2501 │       733 │
│ electronics.audio.music_tools.piano │   60363 │   2280 │       696 │
│ auto.accessories.radar              │   47145 │   2213 │       544 │
│ appliances.environment.fan          │    3316 │     81 │        32 │
│ apparel.shoes.step_ins              │    1750 │     19 │         7 │
│ apparel.glove                       │    3737 │     70 │        17 │
│ apparel.jacket                      │       1 │      0 │         0 │
│ computers.notebook                  │ 2103024 │  59097 │     18433 │
│         ·                           │     ·   │     ·  │        ·  │
│         ·                           │     ·   │     ·  │        ·  │
│         ·                           │     ·   │     ·  │        ·  │
│ auto.accessories.videoregister      │  267878 │   9168 │      2313 │
│ furniture.kitchen.chair             │  180695 │   6286 │      1740 │
│ appliances.kitchen.microwave        │  285186 │  15938 │      5146 │
│ appliances.personal.scales          │   88564 │   4855 │      1577 │
│ kids.fmcg.diapers                   │   29296 │   2463 │       819 │
│ computers.ebooks                    │   45761 │   1870 │       434 │
│ appliances.kitchen.steam_cooker     │   18856 │    578 │       207 │
│ construction.tools.painting         │   19791 │    449 │       109 │
│ apparel.skirt                       │    8766 │     61 │        10 │
│ country_yard.furniture.bench        │       2 │      0 │         0 │
├─────────────────────────────────────┴─────────┴────────┴───────────┤
│ 130 rows (20 shown)                                      4 columns │
└────────────────────────────────────────────────────────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    22    374.9 MiB    374.9 MiB           1   @profile
    23                                         def grouping_conditional_aggregation():
    24    376.8 MiB      1.8 MiB           2       duckdb.sql(
    25    374.9 MiB      0.0 MiB           2           f"""
    26                                                 SELECT
    27                                                     category_code,
    28                                                     SUM(CASE WHEN event_type = 'view' THEN 1 ELSE 0 END) AS views,
    29                                                     SUM(CASE WHEN event_type = 'cart' THEN 1 ELSE 0 END) AS carts,
    30                                                     SUM(CASE WHEN event_type = 'purchase' THEN 1 ELSE 0 END) AS purchases
    31    374.9 MiB      0.0 MiB           1           FROM read_csv_auto('{dataset_path}')
    32                                                 GROUP BY category_code
    33                                                 """
    34    378.4 MiB      1.7 MiB           1       ).show()


Memory = 3.48 MB, Time = 2.37 s
Memory Profiler for Run 8/10

------------------------------------------------


*** Run 9/10 ***

┌───────────────────────────────────┬──────────┬─────────┬───────────┐
│           category_code           │  views   │  carts  │ purchases │
│              varchar              │  int128  │ int128  │  int128   │
├───────────────────────────────────┼──────────┼─────────┼───────────┤
│ auto.accessories.player           │   456658 │   12647 │      3793 │
│ electronics.audio.subwoofer       │   305995 │   10013 │      3130 │
│ electronics.video.tv              │  2071305 │  106467 │     30274 │
│ electronics.camera.video          │    63819 │    1616 │       393 │
│ electronics.tablet                │   464073 │   22286 │      6138 │
│ electronics.audio.microphone      │    44645 │    1615 │       489 │
│ apparel.underwear                 │    47145 │     483 │        84 │
│ appliances.environment.air_heater │   269283 │   13121 │      3583 │
│ apparel.jeans                     │    52145 │     652 │       169 │
│ computers.peripherals.keyboard    │    84909 │    2709 │       707 │
│           ·                       │       ·  │       · │         · │
│           ·                       │       ·  │       · │         · │
│           ·                       │       ·  │       · │         · │
│ apparel.shoes.step_ins            │     1750 │      19 │         7 │
│ appliances.environment.fan        │     3316 │      81 │        32 │
│ apparel.glove                     │     3737 │      70 │        17 │
│ apparel.jacket                    │        1 │       0 │         0 │
│ electronics.smartphone            │ 14832387 │ 1159966 │    382647 │
│ appliances.kitchen.washer         │  1313807 │   70287 │     19772 │
│ appliances.kitchen.coffee_machine │   128164 │    2669 │       724 │
│ computers.components.videocards   │   147797 │    4588 │      1129 │
│ apparel.dress                     │    95954 │     486 │       112 │
│ accessories.umbrella              │     4890 │      73 │        26 │
├───────────────────────────────────┴──────────┴─────────┴───────────┤
│ 130 rows (20 shown)                                      4 columns │
└────────────────────────────────────────────────────────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    22    378.4 MiB    378.4 MiB           1   @profile
    23                                         def grouping_conditional_aggregation():
    24    378.4 MiB      0.0 MiB           2       duckdb.sql(
    25    378.4 MiB      0.0 MiB           2           f"""
    26                                                 SELECT
    27                                                     category_code,
    28                                                     SUM(CASE WHEN event_type = 'view' THEN 1 ELSE 0 END) AS views,
    29                                                     SUM(CASE WHEN event_type = 'cart' THEN 1 ELSE 0 END) AS carts,
    30                                                     SUM(CASE WHEN event_type = 'purchase' THEN 1 ELSE 0 END) AS purchases
    31    378.4 MiB      0.0 MiB           1           FROM read_csv_auto('{dataset_path}')
    32                                                 GROUP BY category_code
    33                                                 """
    34    379.0 MiB      0.6 MiB           1       ).show()


Memory = 0.61 MB, Time = 2.39 s
Memory Profiler for Run 9/10

------------------------------------------------


*** Run 10/10 ***

┌────────────────────────────────────────┬────────┬────────┬───────────┐
│             category_code              │ views  │ carts  │ purchases │
│                varchar                 │ int128 │ int128 │  int128   │
├────────────────────────────────────────┼────────┼────────┼───────────┤
│ auto.accessories.compressor            │  85659 │   2682 │       700 │
│ apparel.costume                        │ 241589 │   2823 │       879 │
│ kids.swing                             │  57430 │   1556 │       482 │
│ apparel.scarf                          │   3567 │     43 │         8 │
│ sport.tennis                           │   7539 │    154 │        48 │
│ appliances.kitchen.fryer               │     99 │      8 │         1 │
│ stationery.cartrige                    │  11943 │    644 │       191 │
│ appliances.kitchen.grill               │ 116721 │   3602 │      1086 │
│ construction.tools.pump                │  41675 │   1568 │       326 │
│ furniture.living_room.sofa             │ 417428 │   6521 │      1562 │
│            ·                           │    ·   │     ·  │        ·  │
│            ·                           │    ·   │     ·  │        ·  │
│            ·                           │    ·   │     ·  │        ·  │
│ furniture.bathroom.bath                │  22472 │    561 │       130 │
│ furniture.bathroom.toilet              │  28060 │    964 │       213 │
│ apparel.shoes.sandals                  │  15139 │    155 │        49 │
│ construction.tools.screw               │    182 │      1 │         1 │
│ furniture.bedroom.bed                  │ 519487 │  10229 │      2957 │
│ appliances.kitchen.coffee_grinder      │  18206 │    559 │       141 │
│ kids.dolls                             │  86219 │   1710 │       437 │
│ appliances.environment.air_conditioner │  97701 │   3046 │       785 │
│ apparel.sock                           │   3455 │    101 │        19 │
│ appliances.ironing_board               │  60187 │   2744 │       890 │
├────────────────────────────────────────┴────────┴────────┴───────────┤
│ 130 rows (20 shown)                                        4 columns │
└──────────────────────────────────────────────────────────────────────┘

Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/duckdb_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    22    379.0 MiB    379.0 MiB           1   @profile
    23                                         def grouping_conditional_aggregation():
    24    379.0 MiB      0.0 MiB           2       duckdb.sql(
    25    379.0 MiB      0.0 MiB           2           f"""
    26                                                 SELECT
    27                                                     category_code,
    28                                                     SUM(CASE WHEN event_type = 'view' THEN 1 ELSE 0 END) AS views,
    29                                                     SUM(CASE WHEN event_type = 'cart' THEN 1 ELSE 0 END) AS carts,
    30                                                     SUM(CASE WHEN event_type = 'purchase' THEN 1 ELSE 0 END) AS purchases
    31    379.0 MiB      0.0 MiB           1           FROM read_csv_auto('{dataset_path}')
    32                                                 GROUP BY category_code
    33                                                 """
    34    441.9 MiB     62.9 MiB           1       ).show()


Memory = 62.89 MB, Time = 2.45 s
Memory Profiler for Run 10/10

--- Elapsed Time (s) ---
Mean:   2.40
Std:    0.04
CV:     1.5%
Min:    2.35
Max:    2.45
Span:   0.10

--- Memory Used (MB) ---
Mean:   29.88
Std:    66.82
CV:     223.6%
Min:    0.61
Max:    212.28
Span:   211.67

[RUN] grouping_conditional_aggregation | hot | polars
------------------------------------------------


*** Run 1/10 ***

shape: (130, 4)
┌─────────────────────────────────┬────────┬───────┬───────────┐
│ category_code                   ┆ views  ┆ carts ┆ purchases │
│ ---                             ┆ ---    ┆ ---   ┆ ---       │
│ str                             ┆ u32    ┆ u32   ┆ u32       │
╞═════════════════════════════════╪════════╪═══════╪═══════════╡
│ kids.carriage                   ┆ 336311 ┆ 8491  ┆ 2674      │
│ sport.trainer                   ┆ 93430  ┆ 2671  ┆ 693       │
│ apparel.shirt                   ┆ 50460  ┆ 513   ┆ 122       │
│ country_yard.cultivator         ┆ 9557   ┆ 162   ┆ 18        │
│ construction.tools.pump         ┆ 41675  ┆ 1568  ┆ 326       │
│ …                               ┆ …      ┆ …     ┆ …         │
│ appliances.kitchen.steam_cooke… ┆ 18856  ┆ 578   ┆ 207       │
│ furniture.bathroom.bath         ┆ 22472  ┆ 561   ┆ 130       │
│ sport.snowboard                 ┆ 17375  ┆ 423   ┆ 138       │
│ sport.bicycle                   ┆ 106037 ┆ 2227  ┆ 536       │
│ country_yard.furniture.bench    ┆ 2      ┆ 0     ┆ 0         │
└─────────────────────────────────┴────────┴───────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23    142.8 MiB    142.8 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  20639.0 MiB  20496.2 MiB           1       df = pl.read_csv(dataset_path)
    26   5363.9 MiB -15242.4 MiB           1       result = (
    27  20606.5 MiB    -32.5 MiB           1           df.group_by("category_code")
    28  20606.2 MiB  -6560.5 MiB           2           .agg([
    29  11924.2 MiB  -8682.1 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30  11924.2 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31  11924.2 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   5364.1 MiB      0.2 MiB           1       print(result)


Memory = 5233.06 MB, Time = 7.15 s
Memory Profiler for Run 1/10

------------------------------------------------


*** Run 2/10 ***

shape: (130, 4)
┌─────────────────────────────────┬──────────┬─────────┬───────────┐
│ category_code                   ┆ views    ┆ carts   ┆ purchases │
│ ---                             ┆ ---      ┆ ---     ┆ ---       │
│ str                             ┆ u32      ┆ u32     ┆ u32       │
╞═════════════════════════════════╪══════════╪═════════╪═══════════╡
│ apparel.jeans                   ┆ 52145    ┆ 652     ┆ 169       │
│ apparel.jumper                  ┆ 31269    ┆ 324     ┆ 82        │
│ electronics.camera.video        ┆ 63819    ┆ 1616    ┆ 393       │
│ medicine.tools.tonometer        ┆ 20764    ┆ 1274    ┆ 344       │
│ appliances.kitchen.coffee_grin… ┆ 18206    ┆ 559     ┆ 141       │
│ …                               ┆ …        ┆ …       ┆ …         │
│ appliances.ironing_board        ┆ 60187    ┆ 2744    ┆ 890       │
│ apparel.skirt                   ┆ 8766     ┆ 61      ┆ 10        │
│ electronics.smartphone          ┆ 14832387 ┆ 1159966 ┆ 382647    │
│ construction.tools.saw          ┆ 185580   ┆ 7488    ┆ 1810      │
│ construction.tools.painting     ┆ 19791    ┆ 449     ┆ 109       │
└─────────────────────────────────┴──────────┴─────────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   5375.6 MiB   5375.6 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  11706.6 MiB   6331.0 MiB           1       df = pl.read_csv(dataset_path)
    26   6066.4 MiB      0.1 MiB           1       result = (
    27   4603.6 MiB  -7103.0 MiB           1           df.group_by("category_code")
    28   6066.2 MiB   1461.6 MiB           2           .agg([
    29   4604.6 MiB      1.0 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30   4604.6 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31   4604.6 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   6067.1 MiB      0.7 MiB           1       print(result)


Memory = 703.06 MB, Time = 15.84 s
Memory Profiler for Run 2/10

------------------------------------------------


*** Run 3/10 ***

shape: (130, 4)
┌─────────────────────────────────┬─────────┬───────┬───────────┐
│ category_code                   ┆ views   ┆ carts ┆ purchases │
│ ---                             ┆ ---     ┆ ---   ┆ ---       │
│ str                             ┆ u32     ┆ u32   ┆ u32       │
╞═════════════════════════════════╪═════════╪═══════╪═══════════╡
│ electronics.audio.subwoofer     ┆ 305995  ┆ 10013 ┆ 3130      │
│ furniture.universal.light       ┆ 15856   ┆ 185   ┆ 47        │
│ appliances.kitchen.coffee_grin… ┆ 18206   ┆ 559   ┆ 141       │
│ appliances.kitchen.kettle       ┆ 264161  ┆ 12196 ┆ 3559      │
│ apparel.glove                   ┆ 3737    ┆ 70    ┆ 17        │
│ …                               ┆ …       ┆ …     ┆ …         │
│ computers.peripherals.monitor   ┆ 203806  ┆ 5923  ┆ 1613      │
│ appliances.environment.water_h… ┆ 194075  ┆ 11914 ┆ 3382      │
│ electronics.video.projector     ┆ 22423   ┆ 418   ┆ 99        │
│ apparel.shoes.ballet_shoes      ┆ 4299    ┆ 58    ┆ 22        │
│ appliances.environment.vacuum   ┆ 1445029 ┆ 64836 ┆ 18193     │
└─────────────────────────────────┴─────────┴───────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   6080.9 MiB   6080.9 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25   6566.9 MiB    486.0 MiB           1       df = pl.read_csv(dataset_path)
    26   8062.2 MiB      0.0 MiB           1       result = (
    27   6567.4 MiB      0.5 MiB           1           df.group_by("category_code")
    28   8062.2 MiB   1493.8 MiB           2           .agg([
    29   6568.8 MiB      1.5 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30   6568.8 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31   6568.5 MiB     -0.4 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   8062.5 MiB      0.2 MiB           1       print(result)


Memory = 1996.17 MB, Time = 16.55 s
Memory Profiler for Run 3/10

------------------------------------------------


*** Run 4/10 ***

shape: (130, 4)
┌───────────────────────────────┬──────────┬────────┬───────────┐
│ category_code                 ┆ views    ┆ carts  ┆ purchases │
│ ---                           ┆ ---      ┆ ---    ┆ ---       │
│ str                           ┆ u32      ┆ u32    ┆ u32       │
╞═══════════════════════════════╪══════════╪════════╪═══════════╡
│ apparel.shoes                 ┆ 1836676  ┆ 40074  ┆ 10140     │
│ computers.components.cpu      ┆ 81644    ┆ 2139   ┆ 510       │
│ furniture.kitchen.chair       ┆ 180695   ┆ 6286   ┆ 1740      │
│ construction.tools.painting   ┆ 19791    ┆ 449    ┆ 109       │
│ appliances.environment.fan    ┆ 3316     ┆ 81     ┆ 32        │
│ …                             ┆ …        ┆ …      ┆ …         │
│ appliances.kitchen.washer     ┆ 1313807  ┆ 70287  ┆ 19772     │
│ null                          ┆ 20837460 ┆ 826493 ┆ 234218    │
│ appliances.environment.vacuum ┆ 1445029  ┆ 64836  ┆ 18193     │
│ auto.accessories.player       ┆ 456658   ┆ 12647  ┆ 3793      │
│ apparel.shoes.espadrilles     ┆ 1404     ┆ 8      ┆ 0         │
└───────────────────────────────┴──────────┴────────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   8076.9 MiB   8076.9 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  17295.5 MiB   9218.5 MiB           1       df = pl.read_csv(dataset_path)
    26   5801.1 MiB  -9909.4 MiB           1       result = (
    27  15742.7 MiB  -1552.8 MiB           1           df.group_by("category_code")
    28  15710.5 MiB  -2997.3 MiB           2           .agg([
    29   8766.1 MiB  -6944.4 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30   8766.1 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31   8766.1 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   5801.7 MiB      0.6 MiB           1       print(result)


Memory = -2256.56 MB, Time = 15.16 s
Memory Profiler for Run 4/10

------------------------------------------------


*** Run 5/10 ***

shape: (130, 4)
┌────────────────────────────────┬────────┬───────┬───────────┐
│ category_code                  ┆ views  ┆ carts ┆ purchases │
│ ---                            ┆ ---    ┆ ---   ┆ ---       │
│ str                            ┆ u32    ┆ u32   ┆ u32       │
╞════════════════════════════════╪════════╪═══════╪═══════════╡
│ furniture.bedroom.blanket      ┆ 28269  ┆ 657   ┆ 214       │
│ apparel.costume                ┆ 241589 ┆ 2823  ┆ 879       │
│ electronics.tablet             ┆ 464073 ┆ 22286 ┆ 6138      │
│ construction.components.faucet ┆ 45919  ┆ 1322  ┆ 388       │
│ auto.accessories.parktronic    ┆ 14337  ┆ 271   ┆ 73        │
│ …                              ┆ …      ┆ …     ┆ …         │
│ apparel.jeans                  ┆ 52145  ┆ 652   ┆ 169       │
│ apparel.shorts                 ┆ 639    ┆ 11    ┆ 2         │
│ sport.tennis                   ┆ 7539   ┆ 154   ┆ 48        │
│ computers.peripherals.monitor  ┆ 203806 ┆ 5923  ┆ 1613      │
│ furniture.living_room.chair    ┆ 85811  ┆ 1946  ┆ 571       │
└────────────────────────────────┴────────┴───────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   5820.7 MiB   5820.7 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  19453.4 MiB  13632.7 MiB           1       df = pl.read_csv(dataset_path)
    26   5852.8 MiB  -5265.9 MiB           1       result = (
    27  11118.6 MiB  -8334.8 MiB           1           df.group_by("category_code")
    28  11118.6 MiB  -5267.0 MiB           2           .agg([
    29  11119.7 MiB      1.0 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30  11119.7 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31  11119.7 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   5853.4 MiB      0.6 MiB           1       print(result)


Memory = 48.92 MB, Time = 13.83 s
Memory Profiler for Run 5/10

------------------------------------------------


*** Run 6/10 ***

shape: (130, 4)
┌─────────────────────────────────┬──────────┬────────┬───────────┐
│ category_code                   ┆ views    ┆ carts  ┆ purchases │
│ ---                             ┆ ---      ┆ ---    ┆ ---       │
│ str                             ┆ u32      ┆ u32    ┆ u32       │
╞═════════════════════════════════╪══════════╪════════╪═══════════╡
│ electronics.telephone           ┆ 327630   ┆ 14832  ┆ 4338      │
│ auto.accessories.parktronic     ┆ 14337    ┆ 271    ┆ 73        │
│ appliances.personal.hair_cutte… ┆ 85361    ┆ 3592   ┆ 1162      │
│ null                            ┆ 20837460 ┆ 826493 ┆ 234218    │
│ electronics.audio.music_tools.… ┆ 60363    ┆ 2280   ┆ 696       │
│ …                               ┆ …        ┆ …      ┆ …         │
│ appliances.personal.massager    ┆ 42291    ┆ 1468   ┆ 522       │
│ appliances.kitchen.mixer        ┆ 140422   ┆ 5719   ┆ 1724      │
│ appliances.sewing_machine       ┆ 266114   ┆ 11580  ┆ 2909      │
│ sport.tennis                    ┆ 7539     ┆ 154    ┆ 48        │
│ auto.accessories.player         ┆ 456658   ┆ 12647  ┆ 3793      │
└─────────────────────────────────┴──────────┴────────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   5869.8 MiB   5869.8 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  11413.1 MiB   5543.4 MiB           1       df = pl.read_csv(dataset_path)
    26   6514.6 MiB  -3093.4 MiB           1       result = (
    27   9608.0 MiB  -1805.2 MiB           1           df.group_by("category_code")
    28   9608.0 MiB  -3094.5 MiB           2           .agg([
    29   9609.0 MiB      1.0 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30   9609.0 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31   9609.0 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   6515.5 MiB      0.9 MiB           1       print(result)


Memory = 664.45 MB, Time = 14.33 s
Memory Profiler for Run 6/10

------------------------------------------------


*** Run 7/10 ***

shape: (130, 4)
┌───────────────────────────────┬────────┬───────┬───────────┐
│ category_code                 ┆ views  ┆ carts ┆ purchases │
│ ---                           ┆ ---    ┆ ---   ┆ ---       │
│ str                           ┆ u32    ┆ u32   ┆ u32       │
╞═══════════════════════════════╪════════╪═══════╪═══════════╡
│ construction.tools.painting   ┆ 19791  ┆ 449   ┆ 109       │
│ construction.tools.pump       ┆ 41675  ┆ 1568  ┆ 326       │
│ appliances.personal.massager  ┆ 42291  ┆ 1468  ┆ 522       │
│ computers.components.cpu      ┆ 81644  ┆ 2139  ┆ 510       │
│ computers.peripherals.camera  ┆ 7061   ┆ 194   ┆ 36        │
│ …                             ┆ …      ┆ …     ┆ …         │
│ electronics.telephone         ┆ 327630 ┆ 14832 ┆ 4338      │
│ stationery.cartrige           ┆ 11943  ┆ 644   ┆ 191       │
│ appliances.kitchen.dishwasher ┆ 156018 ┆ 3896  ┆ 1018      │
│ auto.accessories.winch        ┆ 5876   ┆ 56    ┆ 20        │
│ kids.dolls                    ┆ 86219  ┆ 1710  ┆ 437       │
└───────────────────────────────┴────────┴───────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   6534.5 MiB   6534.5 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  18099.4 MiB  11564.9 MiB           1       df = pl.read_csv(dataset_path)
    26   6357.3 MiB  -4144.9 MiB           1       result = (
    27  10502.2 MiB  -7597.3 MiB           1           df.group_by("category_code")
    28  10502.2 MiB  -4146.1 MiB           2           .agg([
    29  10503.2 MiB      1.0 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30  10503.2 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31  10503.2 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   6358.0 MiB      0.7 MiB           1       print(result)


Memory = -158.11 MB, Time = 14.60 s
Memory Profiler for Run 7/10

------------------------------------------------


*** Run 8/10 ***

shape: (130, 4)
┌─────────────────────────────────┬──────────┬────────┬───────────┐
│ category_code                   ┆ views    ┆ carts  ┆ purchases │
│ ---                             ┆ ---      ┆ ---    ┆ ---       │
│ str                             ┆ u32      ┆ u32    ┆ u32       │
╞═════════════════════════════════╪══════════╪════════╪═══════════╡
│ appliances.kitchen.microwave    ┆ 285186   ┆ 15938  ┆ 5146      │
│ computers.peripherals.printer   ┆ 209130   ┆ 9900   ┆ 2698      │
│ computers.notebook              ┆ 2103024  ┆ 59097  ┆ 18433     │
│ construction.tools.welding      ┆ 141960   ┆ 5431   ┆ 1119      │
│ auto.accessories.compressor     ┆ 85659    ┆ 2682   ┆ 700       │
│ …                               ┆ …        ┆ …      ┆ …         │
│ appliances.kitchen.juicer       ┆ 71894    ┆ 2501   ┆ 733       │
│ construction.tools.light        ┆ 30203    ┆ 493    ┆ 88        │
│ computers.components.power_sup… ┆ 33989    ┆ 1179   ┆ 346       │
│ furniture.bathroom.toilet       ┆ 28060    ┆ 964    ┆ 213       │
│ null                            ┆ 20837460 ┆ 826493 ┆ 234218    │
└─────────────────────────────────┴──────────┴────────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   6376.4 MiB   6376.4 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  11445.0 MiB   5068.6 MiB           1       df = pl.read_csv(dataset_path)
    26   6378.9 MiB  -4315.9 MiB           1       result = (
    27  10694.8 MiB   -750.2 MiB           1           df.group_by("category_code")
    28  10694.8 MiB  -4317.1 MiB           2           .agg([
    29  10695.8 MiB      1.0 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30  10695.8 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31  10695.8 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   6379.5 MiB      0.6 MiB           1       print(result)


Memory = 20.75 MB, Time = 13.93 s
Memory Profiler for Run 8/10

------------------------------------------------


*** Run 9/10 ***

shape: (130, 4)
┌───────────────────────────────┬────────┬───────┬───────────┐
│ category_code                 ┆ views  ┆ carts ┆ purchases │
│ ---                           ┆ ---    ┆ ---   ┆ ---       │
│ str                           ┆ u32    ┆ u32   ┆ u32       │
╞═══════════════════════════════╪════════╪═══════╪═══════════╡
│ appliances.kitchen.hood       ┆ 191699 ┆ 5874  ┆ 1484      │
│ auto.accessories.winch        ┆ 5876   ┆ 56    ┆ 20        │
│ apparel.glove                 ┆ 3737   ┆ 70    ┆ 17        │
│ apparel.trousers              ┆ 25019  ┆ 240   ┆ 50        │
│ computers.peripherals.printer ┆ 209130 ┆ 9900  ┆ 2698      │
│ …                             ┆ …      ┆ …     ┆ …         │
│ sport.trainer                 ┆ 93430  ┆ 2671  ┆ 693       │
│ kids.fmcg.diapers             ┆ 29296  ┆ 2463  ┆ 819       │
│ computers.peripherals.mouse   ┆ 109467 ┆ 5002  ┆ 1321      │
│ computers.components.cpu      ┆ 81644  ┆ 2139  ┆ 510       │
│ furniture.universal.light     ┆ 15856  ┆ 185   ┆ 47        │
└───────────────────────────────┴────────┴───────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   6397.3 MiB   6397.3 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  10782.3 MiB   4385.0 MiB           1       df = pl.read_csv(dataset_path)
    26   5505.5 MiB  -2927.7 MiB           1       result = (
    27   8433.2 MiB  -2349.0 MiB           1           df.group_by("category_code")
    28   8433.2 MiB  -2928.9 MiB           2           .agg([
    29   8434.3 MiB      1.0 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30   8434.3 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31   8434.3 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   5506.4 MiB      0.9 MiB           1       print(result)


Memory = -872.39 MB, Time = 15.81 s
Memory Profiler for Run 9/10

------------------------------------------------


*** Run 10/10 ***

shape: (130, 4)
┌────────────────────────────┬─────────┬───────┬───────────┐
│ category_code              ┆ views   ┆ carts ┆ purchases │
│ ---                        ┆ ---     ┆ ---   ┆ ---       │
│ str                        ┆ u32     ┆ u32   ┆ u32       │
╞════════════════════════════╪═════════╪═══════╪═══════════╡
│ electronics.audio.acoustic ┆ 137239  ┆ 3630  ┆ 1153      │
│ apparel.jumper             ┆ 31269   ┆ 324   ┆ 82        │
│ furniture.kitchen.chair    ┆ 180695  ┆ 6286  ┆ 1740      │
│ appliances.kitchen.oven    ┆ 362455  ┆ 13149 ┆ 3734      │
│ furniture.living_room.sofa ┆ 417428  ┆ 6521  ┆ 1562      │
│ …                          ┆ …       ┆ …     ┆ …         │
│ computers.notebook         ┆ 2103024 ┆ 59097 ┆ 18433     │
│ apparel.shoes.ballet_shoes ┆ 4299    ┆ 58    ┆ 22        │
│ apparel.shoes.sandals      ┆ 15139   ┆ 155   ┆ 49        │
│ electronics.camera.video   ┆ 63819   ┆ 1616  ┆ 393       │
│ apparel.shoes              ┆ 1836676 ┆ 40074 ┆ 10140     │
└────────────────────────────┴─────────┴───────┴───────────┘
Filename: /Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/polars_olap.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    23   5525.0 MiB   5525.0 MiB           1   @profile
    24                                         def grouping_conditional_aggregation():
    25  18923.0 MiB  13398.0 MiB           1       df = pl.read_csv(dataset_path)
    26   5857.5 MiB -12438.7 MiB           1       result = (
    27  18296.4 MiB   -626.6 MiB           1           df.group_by("category_code")
    28  18296.2 MiB  -4718.0 MiB           2           .agg([
    29  10575.1 MiB  -7721.1 MiB           1               (pl.col("event_type") == "view").sum().alias("views"),
    30  10575.1 MiB      0.0 MiB           1               (pl.col("event_type") == "cart").sum().alias("carts"),
    31  10575.1 MiB      0.0 MiB           1               (pl.col("event_type") == "purchase").sum().alias("purchases"),
    32                                                 ])
    33                                             )
    34   5858.4 MiB      0.9 MiB           1       print(result)


Memory = 350.84 MB, Time = 13.80 s
Memory Profiler for Run 10/10

--- Elapsed Time (s) ---
Mean:   14.10
Std:    2.62
CV:     18.6%
Min:    7.15
Max:    16.55
Span:   9.40

--- Memory Used (MB) ---
Mean:   573.02
Std:    1972.76
CV:     344.3%
Min:    -2256.56
Max:    5233.06
Span:   7489.62

=== Phase 2: Plotting figures (saving to disk, no pop-ups) ===
[PLOT] Line: grouping_conditional_aggregation | cold | pandas -> results/pandas_grouping_conditional_aggregation_cold.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/pandas_grouping_conditional_aggregation_cold.png
[PLOT] Line: grouping_conditional_aggregation | cold | duckdb -> results/duckdb_grouping_conditional_aggregation_cold.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/duckdb_grouping_conditional_aggregation_cold.png
[PLOT] Line: grouping_conditional_aggregation | cold | polars -> results/polars_grouping_conditional_aggregation_cold.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/polars_grouping_conditional_aggregation_cold.png
[PLOT] Line: grouping_conditional_aggregation | hot | pandas -> results/pandas_grouping_conditional_aggregation_hot.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/pandas_grouping_conditional_aggregation_hot.png
[PLOT] Line: grouping_conditional_aggregation | hot | duckdb -> results/duckdb_grouping_conditional_aggregation_hot.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/duckdb_grouping_conditional_aggregation_hot.png
[PLOT] Line: grouping_conditional_aggregation | hot | polars -> results/polars_grouping_conditional_aggregation_hot.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/polars_grouping_conditional_aggregation_hot.png
[PLOT] Bars: grouping_conditional_aggregation | cold -> results/pandas_duckdb_polars_grouping_conditional_aggregation_cold_bar.png
Figure saved as results/pandas_duckdb_polars_grouping_conditional_aggregation_cold_bar.png
[PLOT] Bars: grouping_conditional_aggregation | hot -> results/pandas_duckdb_polars_grouping_conditional_aggregation_hot_bar.png
Figure saved as results/pandas_duckdb_polars_grouping_conditional_aggregation_hot_bar.png
[PLOT] Hot vs Cold: grouping_conditional_aggregation -> results/pandas_duckdb_polars_grouping_conditional_aggregation_hot_cold_bar.png
Figure saved as results/pandas_duckdb_polars_grouping_conditional_aggregation_hot_cold_bar.png
[PLOT] Multi-line: grouping_conditional_aggregation | cold -> results/pandas_duckdb_polars_grouping_conditional_aggregation_cold.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/pandas_duckdb_polars_grouping_conditional_aggregation_cold.png
[PLOT] Multi-line: grouping_conditional_aggregation | hot -> results/pandas_duckdb_polars_grouping_conditional_aggregation_hot.png
/Users/niklasniggemann/duckdb_motherduck_lab/duckdb_polars_pandas/plotter.py:229: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Figure saved as results/pandas_duckdb_polars_grouping_conditional_aggregation_hot.png
